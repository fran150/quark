<<<<<<< Updated upstream
!function(e,n){"function"==typeof define&&define.amd?define(["knockout","jquery","knockout-mapping","crossroads","hasher","signals","knockout-projections"],n):(e.komapping=ko.mapping,e.$$=n(e.ko,e.$,e.komapping,e.crossroads,e.hasher,e.signals))}(this,function(ko,$,komapping,crossroads,hasher,signals){function escapeRegExp(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function replaceAll(e,n,t){return e.replace(new RegExp(escapeRegExp(n),"g"),t)}function SyncLock(){var e=!1,n=$$.signal();this.lock=function(){e=!1},this.unlock=function(){e=!0,n.dispatch()},this.isLocked=function(){return!e},this.call=function(t){e?t():n.addOnce(function(){e=!0,t()})}}function ComponentError(e,n,t,r,o){this.key=e,this.text=r,this.data=o,this.controller=n,this.component=t,this.level=o&&o.level?o.level:2e3,this.type=o&&o.type?o.type:""}function ComponentErrors(e,n){var t=this;$$.isDefined(e)||(e=""),$$.isDefined(n)||(n="");var r=globalErrors.filter(function(t){return""==e&&""==n?!0:t.controller==e&&t.component==n});this.add=function(t,r){var o=errorKeys++,i=new ComponentError(o,e,n,t,r);return globalErrors.push(i),o},this["throw"]=function(e,n){var r=t.add(e,n);throw globalErrors()[r]},this.resolve=function(e){var n=t.getByKey(e);n&&globalErrors.remove(n)},this.getBy=function(e){return r.filter(function(n){return e(n)})},this.getByKey=function(e){var n=r();for(var t in n){var o=n[t];if(o.key==e)return o}},this.getByType=function(e){return r.filter(function(n){return n.type==e})},this.getByLevel=function(e,n){return r.filter(function(t){return t.level>=e&&t.level<=n})},this.get=function(){return r},this.clear=function(){globalErrors.removeAll(r())}}function applyBehaviour(e,n){if(!$$.isString(n))throw"The behaviour name must be an string. If you specified an array check that all elements are valid behaviour names";if(!behaviours[n])throw"The are no behaviours loaded with the name "+n+".";behaviours[n](e),$$.isDefined(e.$support)||(e.$support={}),$$.isDefined(e.$support.behaviours)||(e.$support.behaviours={}),e.$support.behaviours[n]=!0}function createComponentScopeAccesor(e){var n=function(){return{nodes:e.$componentTemplateNodes}};return n}function createComponentScopeContext(e){var n=e.$parent,t=e.$parentContext,r=e.extend({$component:n.getModel(),$componentTemplateNodes:t.$componentTemplateNodes,$data:n.getScope(),$parent:t.$parent?t.$parent.model:void 0,$parentContext:t.$parentContext,$parents:t.$parents,$rawData:n.getScope(),$root:t.$root});return $$.isArray(r.$parents)&&r.$parents[0]&&r.$parents[0].model&&(r.$parents[0]=r.$parents[0].model),r}function isChildOf(e,n){for(var t=ko.virtualElements.childNodes(e),r=0;r<t.length;r++)if(t[r]==n)return!0;return!1}function findParent(e){for(var n=e.previousSibling;null!=n;){if(isChildOf(n,e))return n;n=n.previousSibling}return null==n?e.parentNode:void 0}function findModelBinderAttribute(e){if(8==e.nodeType){var n=e.nodeValue.match(/model-bind[\s]*:[\s]*\"[\s\S]*?\"/);if(n){var t=n[0].match(/\"[\s\S]*?\"/);if(t){var r=t[0].indexOf('"')+1,o=t[0].indexOf('"',r);return t[0].substring(r,o)}}}else if(e.attributes)for(var i=0;i<e.attributes.length;i++){var a=e.attributes[i];if(a.specified&&"model-bind"==a.name)return a.value}return!1}function createModelBinderAccessor(e){var n=function(){var n=Array(),t=findParent(e);t=findParent(t);var r=findModelBinderAttribute(t);return r&&(n.push(document.createComment(" ko "+r+" ")),n.push(document.createComment(" /ko "))),{nodes:n,"if":n.length>0}};return n}function createModelBinderContext(e){var n=e.$parentContext.$parentContext,t=e.$parent,r=n.extend({$child:t.getModel()});return r}function markReadyAndInformParent(e,n){callReady(e),$$.isDefined(n.$support)&&$$.isDefined(n.$support.tracking)&&$$.isDefined(n.$support.tracking.parent)&&(n.$support.tracking.parentState.ready=!0,callReadied(n.$support.tracking.parent,n.$support.tracking.parentState.propertyName,n),n.$support.tracking.parent.$support.tracking.childReady())}function checkObjectReady(e){for(var n in e.$support.tracking.childs)if(!e.$support.tracking.childs[n].loaded||!e.$support.tracking.childs[n].ready)return!1;return!0}function callReadied(e,n,t){$$.isDefined(e.readied)&&e.readied(n,t),$$.isDefined(e.readiedSignal)&&e.readiedSignal.dispatch(n,t)}function callLoaded(e,n,t){$$.isDefined(e.loaded)&&e.loaded(n,t),$$.isDefined(e.loadedSignal)&&e.loadedSignal.dispatch(n,t)}function callReady(e){$$.isFunction(e.ready)&&e.ready(),$$.isDefined(e.readyLock)&&e.readyLock.unlock()}function initTracking(e,n,t){if(!$$.isString(t))throw"The import value must be an string with the name of the property to create on the parent object";$$.isObject(n.$support)||(n.$support={}),$$.isObject(n.$support.tracking)||(n.$support.tracking={childs:{}}),e.readyLock=$$.lock(),n.loadedSignal=$$.signal(),n.readiedSignal=$$.signal(),n.$support.tracking.childs[t]={},n.$support.tracking.childs[t].load=function(t,r){n[t]=r,n.$support.tracking.childs[t].loaded=!0,callLoaded(n,t,r),n.$support.tracking.childs[t].propertyName=t,$$.isDefined(r.$support)&&$$.isDefined(r.$support.tracking)?(n.$support.tracking.childs[t].ready=!1,r.$support.tracking.parent=n,r.$support.tracking.parentState=n.$support.tracking.childs[t]):(n.$support.tracking.childs[t].ready=!0,callReadied(n,t,r)),checkObjectReady(n)&&markReadyAndInformParent(e,n)},n.$support.tracking.childs[t].loaded=!1,n.$support.tracking.childReady=function(t,r){checkObjectReady(n)&&markReadyAndInformParent(e,n)}}function addExportBinding(e,n){if(8==e.nodeType){var t=e.nodeValue.match(/model-bind[\s]*:[\s]*\"[\s\S]*?\"/);if(t){var r=t[0].match(/\"[\s\S]*?\"/);if(r){var o=r[0].indexOf('"')+1,i=r[0].indexOf('"',o),a=r[0].substring(o,i),s='"'+a;a&&(s+=", "),s+="export: '"+n+"'\"",e.nodeValue=e.nodeValue.replace(r[0],s)}}else e.nodeValue+="model-bind: \"export: '"+n+"'\""}else{var u=!1;if(e.attributes)for(var c=0;c<e.attributes.length;c++){var l=e.attributes[c];l.specified&&"model-bind"==l.name&&(l.value&&(l.value+=", "),l.value+="export: '"+n+"'",u=!0)}if(!u)var l=e.setAttribute("model-bind","export: '"+n+"'")}}function callLoadMethod(e,n,t){if(!$$.isDefined(n.$support)||!$$.isDefined(n.$support.tracking))throw"The specified object doesn´t have the tracking.childs property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(n.$support.tracking.childs))throw"The specified object doesn´t have the tracking property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(n.$support.tracking.childs[e]))throw"The specified object doesn´t have a property named "+e+". Verify that the object has a property defined with the .components method with the name defined in the vm binding.";n.$support.tracking.childs[e].load(e,t.$child)}function createContentAccesor(e,n){var t=ko.unwrap(e()),r=function(){return $$.isDefined(t)?{nodes:$(n.$componentTemplateNodes).filter(t)}:{nodes:n.$componentTemplateNodes}};return r}function createContentContext(e){var n=e.$parentContext,t=e.$data,r=n.extend({$child:t.model});return r}function createHasContentAccesor(e,n){var t=ko.unwrap(e()),r=function(){return $(n.$componentTemplateNodes).filter(t).length>0};return r}function createHasPageAccessor(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){var e=$$.routing.current();return $$.isDefined(e.route.components[i])?!0:!1};return a}function QuarkRouter(){function e(){var e=this;e.configuration={};var n;this.on=function(t,r){if(!$$.isDefined(t))throw"Must define a name for the routes on the page.";return e.configuration[t]={config:r,routes:{}},n=t,e},this.when=function(t,r,o,i){if($$.isDefined(r)||$$.isDefined(o)){if(!$$.isDefined(o)||!$$.isDefined(r))throw"Must define the hash, name and components parameters"}else o=t,r="",t="Any";var a=!1;if("!"==t.charAt(0)&&(a=!0,t=t.substr(1)),!$$.isDefined(n))throw"You must define the location to where this route applies using the .on method before calling .when.";var s=n+"/"+r;return e.configuration[n].routes[r]={hash:t,components:o,fullName:s,name:r,controller:i,persistent:a},e}}function n(e,n,r,o,i,a,s,u){var c=this,l=e.addRoute(i,function(e){function n(e){var n=t.current();if(n&&n.route.controller!=e){if(n.controller&&n.controller.leaving&&n.controller.leaving()===!1)return;n.controller&&(n.controller.componentErrors&&n.controller.componentErrors.clear(),n.route.persistent||(delete n.controller,delete n.route.controller))}t.current({route:c,params:c.params,controller:e}),e&&e.show&&e.show(),t.routed.dispatch(),t.firstRouting.unlock()}function r(e){if(c.controller=e,e&&(e.componentErrors&&console.warn("This controller already have a property named componentErrors, wich will be replaced by the error handler."),e.componentErrors=new ComponentErrors(e),c&&$$.isObject(c.components)))for(var n in c.components)initTracking(e,e,n)}for(var o in c.params)c.params[o](e[o]);$$.isString(s)?require([s],function(e){var t;c.controller?t=c.controller:(t=$$.isFunction(e)?new e(c):e,r(t)),n(t)}):$$.isFunction(s)?s(function(e){r(e),n(e)}):(r(s),n(s))});this.name=n,this.fullName=r,this.hash=i,this.components=a,this.persistent=u,this.params={};for(var d in l._paramsIds)this.params[l._paramsIds[d]]=ko.observable();this.parse=function(n){e.parse(n)},this.interpolate=function(e){return l.interpolate(e)}}var t=this;this.current=ko.observable(),this.configuration={},this.locationFinders=[],this.locationFinders.push(function(e){var n=window.location.pathname;for(var r in t.configuration){var o=t.configuration[r],i=RegExp(o.config);n.match(i)&&e(o)}}),this.routes=function(){return new e},this.configure=function(e){for(var r in e.configuration){var o,i=e.configuration[r];o=t.configuration[r]?t.configuration[r]:t.configuration[r]={},o.router||(o.router=crossroads.create(),o.router.normalizeFn=crossroads.NORM_AS_OBJECT,o.router.ignoreState=!0),i.router=o.router,o.routes||(o.routes={}),o.config||(o.config=i.config);for(var a in i.routes)if(""!==a){var s={};$$.isDefined(o.routes[""])&&$.extend(s,o.routes[""].components),$$.isDefined(i.routes[""])&&$.extend(s,i.routes[""].components);var u=i.routes[a];$.extend(s,u.components);var c=new n(o.router,u.name,u.fullName,i.config,u.hash,s,u.controller,u.persistent);o.routes[a]=c}}},this.parse=function(e){var n=!1;for(var r in t.locationFinders){var o=t.locationFinders[r];if(o(function(t){n=!0,t.router.parse(e)}),n)return}},this.getRoute=function(e){var n=e.substr(0,e.indexOf("/")),r=e.substr(e.indexOf("/")+1);if(!r)throw new"You must specifiy route name in the form location/routeName.";return t.configuration[n]?t.configuration[n].routes[r]||console.warn("The route name specified as "+e+" was not found in the routing configuration for the "+n+" location."):console.warn("The location specified as "+e+" was not found in the routing configuration."),t.configuration[n]&&t.configuration[n].routes[r]?t.configuration[n].routes[r]:void 0},this.hash=function(e,n){var r=t.getRoute(e);return r?r.interpolate(n):void 0},this.activateHasher=function(e){function n(n,r){$$.isDefined(e)?e(n,r):t.parse(n)}hasher.initialized.add(n),hasher.changed.add(n),hasher.init()},this.routed=new signals.Signal,this.firstRouting=$$.lock()}function validateValue(e,n){n||(n=this),n.validationReset();for(var t in n.validationConfig){var r=n.validationConfig[t];if(ko.validators[t]){var o=ko.validators[t](n,r);if(!o.validate(e))return n.componentErrors&&(n.errorKey=n.componentErrors.add(n.validationMessage(),{level:100,type:"validation"})),!1}}return!0}function setFormGroupErrorClass(e,n,t,r,o){var i=n(),a=!1;if($$.isArray(i)){for(var s=0;s<i.length;s++)if(!i[s].hasError()){a=!0;break}}else a=i.hasError();a?$(e).addClass("has-error"):$(e).removeClass("has-error")}var $$={};$$.started=!1,$$.ajaxErrorHandlers={},$$.formatters={},$$.isDefined=function(e){return"undefined"==typeof e?!1:!0},$$.isString=function(e){return"string"==typeof e||e instanceof String?!0:!1},$$.isInt=function(e){return Number(e)===e&&e%1===0},$$.canBeInt=function(e){return Number(e)==e&&e%1===0},$$.isNumeric=function(e){return"number"==typeof e},$$.isDecimal=function(e){return e===Number(e)&&e%1!==0},$$.isArray=function(e){return $.isArray(e)},$$.isObject=function(e){return null===e||"object"!=typeof e||e instanceof Array?!1:!0},$$.isFunction=function(e){return null!==e&&"function"==typeof e?!0:!1},$$.isDate=function(e){return e instanceof Date?!0:!1},$$.isValidDate=function(e){return $$.isDate(e)?isNaN(e.getTime())?!1:!0:!1},$$.clone=function(e){return $.extend(!0,{},e)},$$.cloneObservable=function(e){return komapping.fromJS(komapping.toJS(e))},$$.cloneMixed=function(e){var n=new e.constructor;for(var t in e){var r;ko.isObservable(e[t])?(r=e[t](),$$.isObject(r)?n[t]=ko.observable($$.cloneMixed(r)):n[t]=ko.observable(r)):(r=e[t],$$.isObject(r)?n[t]=$$.cloneMixed(r):n[t]=r)}return n},$$.call=function(e){if(ko.isObservable(e)&&(e=e()),ko.isObservable(e))throw"Callback can not be an observable";if($$.isFunction(e)){var n=Array.prototype.slice.call(arguments,1);return e.apply(null,n)}},$$.makeDate=function(e,n){if($$.isDate(e)||(e=new Date(e)),!$$.isValidDate(e)){if(!n)return void 0;e=new Date}return e},$$.toShortISO=function(e){return $$.isDate(e)?e.toISOString().slice(0,10):void 0},$$.clear=function(e){$.each(e,function(e,n){ko.isObservable(n)?n(void 0):n=void 0})},$$.undefine=function(e){ko.isObservable(e)?e(void 0):e=void 0},$$.formatString=function(){for(var e=Array.prototype.slice.call(arguments),n=e[0],t=1;t<e.length;t++)n=replaceAll(n,"{"+(t-1)+"}",e[t]);return n},$$.formatStringObj=function(e,n){for(var t in n)e=replaceAll(e,"{"+t+"}",n[t]);return e},ko.associativeObservable=function(e){function n(){return arguments.length>0?(n.underlying(arguments[0]),this):n.underlying()}return n.underlying=ko.observable(e),n.add=function(e,t){var r=n.underlying();r||(r={}),r[e]=t,n.underlying(r)},n.get=function(e){var t=n.underlying();return t?t[e]:void 0},n.remove=function(e){var t=n.underlying();t&&$$.isDefined(t[e])&&delete t[e],n.underlying(t)},n.array=ko.pureComputed(function(){var e=n.underlying(),t=[];if(e)for(var r in e){var o=e[r];t.push(o)}return t}),n.each=function(e){var t=n.underlying();if(t)for(var r in t)e(r,t[r])},n.subscribe=function(e){return n.underlying.subscribe(e)},n},ko.observable.fn.refresh=function(){var e=this();$$.undefine(this),this(e)},ko.isObservableArray=function(e){return ko.isObservable(e)&&void 0!==e.indexOf?!0:!1},ko.isComputed=function(e){return null===e||void 0===e||void 0===e.__ko_proto__?!1:e.__ko_proto__===ko.dependentObservable?!0:ko.isComputed(e.__ko_proto__)},ko.mapToJS=function(e){return komapping.toJS(komapping.fromJS(e))},ko.mapFromJS=function(e){return komapping.fromJS(komapping.toJS(e))},ko.bindingHandlers.href={update:function(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){if($$.isString(i))return{href:"#"+$$.routing.hash(i)};if($$.isObject(i)){var e;return i.page&&(e=i.page),i.routeName&&(e+="#"+$$.routing.hash(i.routeName,i.routeConfig)),{href:e}}};return ko.bindingHandlers.attr.update(e,a,t,r,o)}},ko.bindingHandlers.onBind={init:function(e,n,t,r,o){var i=ko.unwrap(n());i(e,r,o)}},ko.bindingHandlers.format={init:function(e,n){var t=n();if(!$$.isDefined(t.value)||!$$.isString(t.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";ko.isObservable(t.value)||(t.value=ko.observable(t.value));var r=ko.pureComputed({read:function(){return $$.isDefined(t.value())&&$$.isDefined(t.formatter)?$$.formatters[t.formatter](t.value()):t.value()}});ko.applyBindingsToNode(e,{text:r})}},ko.bindingHandlers.formatValue={init:function(e,n){var t=n();if(!$$.isDefined(t.value)||!$$.isString(t.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";ko.isObservable(t.value)||(t.value=ko.observable(t.value));var r=ko.pureComputed({read:function(){return $$.isDefined(t.value())&&$$.isDefined(t.formatter)?$$.formatters[t.formatter](t.value()):t.value()}});ko.applyBindingsToNode(e,{value:r})}},$$.signal=function(){return new signals.Signal},$$.signalClear=function(e){e.removeAll()},$$.lock=function(){return new SyncLock},$$.wait=function(e,n){e.call(n)},$$.isLocked=function(e){return e.isLocked()},$$.redirect=function(e){return window.location.href=e,!0},$$.redirectHash=function(e,n){var t=$$.routing.hash(e,n);$$.redirect("#"+t)},$$.getParam=function(e){var n=void 0,t=[];return location.search.substr(1).split("&").forEach(function(r){t=r.split("="),t[0]===e&&(n=decodeURIComponent(t[1]))}),n},$$.replaceAndBind=function(e,n,t){$(e).html(n),ko.cleanNode(e.get(0)),ko.applyBindings(t,e.get(0))},$$.htmlEncode=function(e){return e?$("<div />").text(e).html():""},$$.htmlDecode=function(e){return e?$("<div />").html(e).text():""},$$.limitText=function(e,n){return $$.isInt(n)?6>n&&(n=6):n=6,$$.isString(e)?(e.length>n&&(e=e.substr(0,n-3)+"..."),e):""},$$.setCookie=function(e,n,t){var r=new Date;if(void 0!==t){r.setTime(r.getTime()+1e3*t);var o="expires="+r.toUTCString();document.cookie=e+"="+n+"; "+o}else document.cookie=e+"="+n+"; "},$$.getCookie=function(e){e+="=";for(var n=document.cookie.split(";"),t=0;t<n.length;t++){for(var r=n[t];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""},$$.clearCookie=function(e){$$.setCookie(e,"",-1)},$$.loadCss=function(e){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)};var authorizing=!1;$$.ajaxConfig={contentType:"application/json",dataType:"json",async:!0,cache:!1,authorization:{has:function(){return!0},configAuthorization:function(e){return e},authorize:function(e,n){n(!0)}}},$$.ajax=function(e,n,t,r,o,i){function a(){l=l.authorization.configAuthorization(l),$.ajax(l)}var s=i||{},u=r||{};if(!e)throw"Must specify the target URL";var c;$$.isFunction(u)?c=u:$$.isObject(u)&&(c=u.onSuccess);var l={url:e,type:n||"GET",data:t,success:c,complete:function(){$$.isDefined(u.onComplete)&&u.onComplete()},error:function(n,t,r){var o=!1;if($$.isDefined(u.onError)&&(o=u.onError(n,t,r)),!o)for(var i in $$.ajaxErrorHandlers)if($$.ajaxErrorHandlers[i](e,s.source,n,t,r)){o=!0;break}}};l=$.extend(l,$$.ajaxConfig),l=$.extend(l,s),!authorizing&&o?l.authorization.has()?a():(authorizing=!0,l.authorization.authorize(function(e){authorizing=!1,e&&a()})):$.ajax(l)};var errorKeys=1,globalErrors=ko.observableArray();$$.globalErrors=new ComponentErrors,$$.start=function(e){$$.started||(ko.applyBindings(e),$$.started=!0)},$$.module=function(e,n,t){if(!$$.isDefined(e))throw"Must specify the module configuration. You can define 'module' as dependency and pass that value in this parameter";var r=e.id.substring(0,e.id.lastIndexOf("/")),o=e.uri.substring(0,e.uri.lastIndexOf("/"));if($$.modules.get(r))return $$.modules.get(r);if(n||(n={}),$$.isDefined(n.require)){if(n.require.paths)for(var i in n.require.paths)n.require.paths[i]=o+"/"+n.require.paths[i];require(n.require)}if(n.components)for(var a in n.components){var s=n.prefix+"-"+a,u=r+"/"+n.components[a];$$.registerComponent(s,u)}if(n.namespaces)for(var c in n.namespaces){var l;l=n.prefix?n.prefix+"-"+c:c;var d=$$.onNamespace(l),p=n.namespaces[c];for(var f in p){var u=r+"/"+p[f];d.register(f,u)}}if($$.isArray(n.css))for(var $=0;$<n.css.length;$++)$$.loadCss(o+"/"+n.css[$]);var h={};return t&&(h=new t(r)),h.start&&h.start(),$$.modules.add(r,{name:r,path:o,info:e,config:n,main:h}),$$.modules.get(r)},$$.component=function(e,n){function t(n){var t,r={},o={};if(e&&!t){t=new e(n,r,o);var i=new ComponentErrors($$.controller,t);t&&(t.componentErrors&&console.warn("This component already have a property named componentErrors, wich will be replaced by the quark component error list."),t.componentErrors=i),t&&$$.isFunction(t.initComponent)&&t.initComponent(),r.model=t,r.imports=o,r.componentErrors=i,r.controller=$$.controller}this.getModel=function(){return t},this.getScope=function(){return r},this.getImports=function(){return o},this.dispose=function(){t&&t.dispose&&t.dispose(),o&&o.readyLock&&$$.undefine(o.readyLock),o&&o.readiedSignal&&($$.signalClear(o.readiedSignal),$$.undefine(o.readiedSignal)),o&&o.loadedSignal&&($$.signalClear(o.loadedSignal),$$.undefine(o.loadedSignal)),r&&r.dispose&&r.dispose(),t&&t.componentErrors&&(t.componentErrors.clear(),$$.undefine(t.componentErrors)),$$.undefine(t),$$.undefine(r),$$.undefine(o)}}return $$.isDefined(n)||(n=e,$$.undefine(e)),e?{template:n,viewModel:t}:{template:n}},$$.registerComponent=function(e,n){ko.components.register(e,{require:n})},$$.onNamespace=function(e){var n=this,t=e;return this.register=function(e,r){return $$.registerComponent(t+"-"+e,r),n},n},$$.parameters=function(e,n,t){if(!$$.isObject(e))throw"You must specify a parameters config object";if(!$$.isObject(n))throw"You must specify the configured values for the component, usually you can obtain it from the parameters array received in the component's constructor.";if(!$$.isDefined(t))throw"You must specify the viewmodel of the component in wich to load the parameters.";$$.isArray(t)||(t=Array(t));for(var r in e)for(var o=0;o<t.length;o++){var i=t[o];if($$.isDefined(i[r])&&console.warn("There is already a property named "+r+" in the target component. It will be replaced with the specified parameter."),i[r]=e[r],$$.isDefined(n[r]))if(ko.isObservable(i[r])&&ko.isObservable(n[r]))ko.isComputed(i[r])||(i[r]=n[r]);else if(ko.isObservable(i[r])&&!ko.isObservable(n[r]))i[r](n[r]);else if(!ko.isObservable(i[r])&&ko.isObservable(n[r]))i[r]=n[r]();else if(!ko.isObservable(i[r])&&!ko.isObservable(n[r]))if($$.isFunction(i[r])){if($$.isFunction(n[r]))i[r]=n[r];else if($$.isDefined(n[r]))throw"The parameter "+r+" must be a callback."}else i[r]=n[r]}},$$.inject=function(e,n,t){if($$.isDefined(e)&&$$.isDefined(n))for(var r in e)if($$.isDefined(n[r])){var o;o=ko.isObservable(e[r])?e[r]():e[r],ko.isObservable(n[r])?t&&$$.isObject(n[r]())?$$.inject(o,n[r](),!0):n[r](o):t&&$$.isObject(n[r])?$$.inject(o,n[r],!0):n[r]=o}};var behaviours={};$$.behaviour=function(e,n,t){if($$.behaviour[e]&&console.warn("There was already a behaviour loaded with the name "+e+". It will be replaced with the new one."),!$$.isString(e))throw"The behaviour name must be an string.";if(!$$.isFunction(n))throw"The behaviour must be a function that takes an object as a parameter an applies the new functionality to it.";if($$.isDefined(t)&&!$$.isFunction(t))throw"The behaviour dispose must be a function that performs cleanup of the behaviour when disposing.";n.dispose=t,behaviours[e]=n},$$.behave=function(e,n){if(!$$.isObject(e))throw"You must specifify a valid object to apply the behaviour.";if($$.isArray(n))for(var t=0;t<n.length;t++)applyBehaviour(e,n[t]);else{if(!$$.isString(n))throw"The behaviour name must be an string or an array of strings.";applyBehaviour(e,n)}},$$.hasBehaviour=function(e,n){if(!$$.isObject(e))throw"You must specifify a valid object to check the behaviour.";if(!$$.isString(n))throw"The behaviour name must be an string.";return $$.isDefined(e.$support)&&$$.isDefined(e.$support.behaviours)&&$$.isDefined(e.$support.behaviours[n])?!0:!1},$$.disposeBehaviours=function(e){if(!$$.isObject(e))throw"You must specifify a valid object to apply the behaviour.";if($$.isDefined(e.$support)&&$$.isDefined(e.$support.behaviours))for(var n in e.$support.behaviours){var t=e.$support.behaviours[n];t.dispose&&t.dispose(e)}},$$.modules=ko.associativeObservable({}),$$.emptyTemplate=function(e){return e?"<!-- quark-component --><!-- /quark-component -->":"<quark-component></quark-component>"},ko.bindingProvider.instance.preprocessNode=function(e){if(8==e.nodeType){var n=e.nodeValue.match(/^\s*(quark-component[\s\S]+)/);if(n)return e.data=" ko component: { name: 'quark-component' } ",e;var n=e.nodeValue.match(/^\s*(\/quark-component[\s\S]+)/);if(n)return e.data=" /ko ",e}if(e&&e.nodeName&&ko.components.isRegistered(e.nodeName.toLowerCase())&&e.attributes.virtual){var t=e.attributes.params,r=e.attributes["data-bind"],o=e.attributes["model-bind"],i=" ko component: { name: '"+e.nodeName.toLowerCase()+"' ";t&&(i+=", params: { "+t.value+" } "),i+=" } ",r&&(i+=", "+r.value+" "),o&&(i+=', model-bind: "'+o.value+'"');var a=document.createComment(i),s=document.createComment(" /ko ");for(e.parentNode.insertBefore(s,e.nextSibling),e.parentNode.replaceChild(a,e);e.childNodes.length>0;)a.parentNode.insertBefore(e.childNodes[0],s);return[a,s]}},ko.bindingHandlers.waitReady={init:function(e,n,t,r,o){var i=n(),a=ko.observable(!1);return r&&r.readiedSignal&&r.readiedSignal.addOnce(function(e){e==i&&a(!0)}),ko.bindingHandlers["if"].init(e,a,t,r,o)}},ko.virtualElements.allowedBindings.waitReady=!0,ko.bindingHandlers.namespace={init:function(e,n,t,r,o){var i=n(),a=t.get("alias")||400;if(!$$.isString(i))throw"Must specify namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";if(!$$.isString(a))throw"Must specify alias to namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";var s=i.toLowerCase();a=a.toLowerCase(),o&&(o.namespaces||(o.namespaces={}),o.namespaces[a]=s)}},ko.virtualElements.allowedBindings.namespace=!0,ko.components.getComponentNameForNode=function(e){var n=e.tagName&&e.tagName.toLowerCase();if(ko.components.isRegistered(n))return n;if(-1!==n.indexOf(":")){var t=n.split(":"),r=t[0],o=t[1],i=ko.contextFor(e);if(i&&$$.isObject(i.namespaces)&&i.namespaces[r]){var a=i.namespaces[r],s=a+"-"+o;if(ko.components.isRegistered(s))return s}}return null},ko.components.register("quark-component",{template:"<!-- ko componentScope --><!-- /ko --><!-- ko modelBinder --><!-- /ko -->"}),ko.bindingHandlers.componentScope={init:function(e,n,t,r,o){var i=createComponentScopeAccesor(o),a=createComponentScopeContext(o);return ko.bindingHandlers.template.init(e,i,t,a.$data,a)},update:function(e,n,t,r,o){var i=createComponentScopeAccesor(o),a=createComponentScopeContext(o);return ko.bindingHandlers.template.update(e,i,t,a.$data,a)}},ko.virtualElements.allowedBindings.componentScope=!0,ko.bindingHandlers.modelBinder={init:function(e,n,t,r,o){var i=createModelBinderAccessor(e),a=createModelBinderContext(o);return ko.bindingHandlers.template.init(e,i,t,o.$parent,a)},update:function(e,n,t,r,o){var i=createModelBinderAccessor(e),a=createModelBinderContext(o);return ko.bindingHandlers.template.update(e,i,t,o.$parent,a)}},ko.virtualElements.allowedBindings.modelBinder=!0,ko.bindingHandlers["import"]={init:function(e,n,t,r,o){var i,a,s=n();r&&r.imports&&r.model?(i=r.model,a=r.imports):(i=r,a=r),initTracking(i,a,s),a[s]={},addExportBinding(e,s)}},ko.virtualElements.allowedBindings["import"]=!0,ko.bindingHandlers["export"]={init:function(e,n,t,r,o){var i;i=ko.unwrap(n()),r&&r.imports&&(r=r.imports);var a;if(!$$.isString(i))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";a=i,callLoadMethod(a,r,o)}},ko.virtualElements.allowedBindings["export"]=!0,ko.bindingHandlers.exporttocontroller={init:function(e,n,t,r,o){var i;i=ko.unwrap(n());var a=$$.routing.current();if(a&&a.controller){r=a.controller;var s;if($$.isString(i)?s=i:$$.isObject(i)&&($$.isString(i.property)&&(s=i.property),$$.isDefined(i.model)&&(r=i.model)),!$$.isString(s))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";if(!$$.isDefined(r.$support)||!$$.isDefined(r.$support.tracking))throw"The specified object doesn´t have the tracking.childs property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs))throw"The specified object doesn´t have the tracking property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs[s]))throw"The specified object doesn´t have a property named "+i+". Verify that the object has a property defined with the .components method with the name defined in the vm binding.";r.$support.tracking.childs[s].load(s,o.$child)}}},ko.virtualElements.allowedBindings.exporttocontroller=!0,ko.bindingHandlers.content={init:function(e,n,t,r,o){var i=createContentAccesor(n,o),a=createContentContext(o);return ko.bindingHandlers.template.init(e,i,t,o.$parent,a)},update:function(e,n,t,r,o){var i=createContentAccesor(n,o),a=createContentContext(o);return ko.bindingHandlers.template.update(e,i,t,o.$parent,a)}},ko.virtualElements.allowedBindings.content=!0,ko.bindingHandlers.hasContent={init:function(e,n,t,r,o){var i=createHasContentAccesor(n,o);return ko.bindingHandlers["if"].init(e,i,t,o,o)}},ko.virtualElements.allowedBindings.hasContent=!0,ko.bindingHandlers.hasNotContent={init:function(e,n,t,r,o){var i=createHasContentAccesor(e,n,t,r,o);return ko.bindingHandlers.ifnot.init(e,i,t,o,o)}},ko.virtualElements.allowedBindings.hasNotContent=!0,ko.bindingHandlers.page={init:function(element,valueAccessor,allBindingsAccessor,viewModel,context){var name=ko.unwrap(valueAccessor()),current={component:ko.observable(),parameters:ko.observable()},updater=ko.computed(function(){var currentRoute=$$.routing.current(),component,params;if(currentRoute){if($$.isArray(currentRoute.route.components[name])){component=currentRoute.route.components[name][0];var componentParams=currentRoute.route.components[name][1];$$.isString(componentParams)&&eval("params = {"+componentParams+"}"),$$.isObject(componentParams)&&$$.isString(componentParams.controller)&&eval("params = $$.controller."+componentParams.controller+"()")}else component=currentRoute.route.components[name],params=currentRoute;var persistent=!1;"!"==component.charAt(0)&&(persistent=!0,component=component.substr(1)),current.component()==component&&persistent||(current.component(component),current.parameters(params))}}),newAccesor=function(){return{name:current.component,params:current.parameters}};return 8!=element.nodeType,ko.utils.domNodeDisposal.addDisposeCallback(element,function(){updater.dispose()}),ko.bindingHandlers.component.init(element,newAccesor,allBindingsAccessor,viewModel,context)}},ko.virtualElements.allowedBindings.page=!0,ko.bindingHandlers.hasPage={init:function(e,n,t,r,o){var i=createHasPageAccessor(e,n,t,r,o);return ko.bindingHandlers["if"].init(e,i,t,r,o)}},ko.virtualElements.allowedBindings.hasPage=!0,$$.routing=new QuarkRouter,$$.controller={};var controllerUpdater=ko.computed(function(){var e=$$.routing.current();e&&(e.controller?$$.controller=e.controller:$$.controller={})});return ko.validators={},ko.validate=function(e,n){var t=!0;for(var r in e){var o=e[r];ko.isObservable(o)&&o.validatable&&(o.validate(n)||(t=!1))}return t},ko.unsubscribeValidation=function(e){for(var n in e){var t=e[n];ko.isObservable(t)&&t.validatable&&t.validationSubscription&&(t.validationSubscription.dispose(),delete t.validationSubscription)}},ko.validationReset=function(e){for(var n in e){var t=e[n];ko.isObservable(t)&&t.validatable&&t.validationReset()}},ko.observable.fn.validation=function(e,n,t){return this.validatable=e,this.validationConfig=n,this.hasError=ko.observable(),this.validationMessage=ko.observable(),t&&(this.componentErrors=t),this},ko.observable.fn.validationReset=function(){this.validatable&&(this.hasError(!1),this.validationMessage(""),this.componentErrors&&this.errorKey&&this.componentErrors.resolve(this.errorKey))},ko.observable.fn.validate=function(e){return e&&!this.validationSubscription&&(this.validationSubscription=this.subscribe(validateValue,this)),validateValue(this(),this)},ko.bindingHandlers.formGroupError={init:function(e,n,t,r,o){setFormGroupErrorClass(e,n,t,r,o)},update:function(e,n,t,r,o){setFormGroupErrorClass(e,n,t,r,o)}},ko.bindingHandlers.fieldError={
init:function(e,n,t,r,o){var i=function(){return n().validationMessage};ko.bindingHandlers.text.init(e,i,t,r,o)},update:function(e,n,t,r,o){var i=function(){return n().hasError},a=function(){return n().validationMessage};ko.bindingHandlers.visible.update(e,i,t,r,o),ko.bindingHandlers.text.update(e,a,t,r,o)}},"function"==typeof define&&define.amd&&define("knockout",function(){return ko}),$$});
=======
!function(e,n){"function"==typeof define&&define.amd?define(["knockout","jquery","knockout-mapping","crossroads","hasher","signals","knockout-projections"],n):(e.komapping=ko.mapping,e.$$=n(e.ko,e.$,e.komapping,e.crossroads,e.hasher,e.signals))}(this,function(ko,$,komapping,crossroads,hasher,signals){function escapeRegExp(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function replaceAll(e,n,t){return e.replace(new RegExp(escapeRegExp(n),"g"),t)}function SyncLock(){var e=!1,n=$$.signal();this.lock=function(){e=!1},this.unlock=function(){e=!0,n.dispatch()},this.isLocked=function(){return!e},this.call=function(t){e?t():n.addOnce(function(){e=!0,t()})}}function ComponentError(e,n,t,r,o){this.key=e,this.text=r,this.data=o,this.controller=n,this.component=t,this.level=o&&o.level?o.level:2e3,this.type=o&&o.type?o.type:""}function ComponentErrors(e,n){var t=this;$$.isDefined(e)||(e=""),$$.isDefined(n)||(n="");var r=globalErrors.filter(function(t){return""==e&&""==n?!0:t.controller==e&&t.component==n});this.add=function(t,r){var o=errorKeys++,i=new ComponentError(o,e,n,t,r);return globalErrors.push(i),o},this["throw"]=function(e,n){var r=t.add(e,n);throw globalErrors()[r]},this.resolve=function(e){var n=t.getByKey(e);n&&globalErrors.remove(n)},this.getBy=function(e){return r.filter(function(n){return e(n)})},this.getByKey=function(e){var n=r();for(var t in n){var o=n[t];if(o.key==e)return o}},this.getByType=function(e){return r.filter(function(n){return n.type==e})},this.getByLevel=function(e,n){return r.filter(function(t){return t.level>=e&&t.level<=n})},this.get=function(){return r},this.clear=function(){globalErrors.removeAll(r())}}function applyBehaviour(e,n){if(!$$.isString(n))throw"The behaviour name must be an string. If you specified an array check that all elements are valid behaviour names";if(!behaviours[n])throw"The are no behaviours loaded with the name "+n+".";behaviours[n](e),$$.isDefined(e.$support)||(e.$support={}),$$.isDefined(e.$support.behaviours)||(e.$support.behaviours={}),e.$support.behaviours[n]=!0}function markReadyAndInformParent(e){callReady(e),$$.isDefined(e.$support)&&$$.isDefined(e.$support.tracking)&&$$.isDefined(e.$support.tracking.parent)&&(e.$support.tracking.parentState.ready=!0,callReadied(e.$support.tracking.parent,e.$support.tracking.parentState.propertyName,e),e.$support.tracking.parent.$support.tracking.childReady())}function checkObjectReady(e){for(var n in e.$support.tracking.childs)if(!e.$support.tracking.childs[n].loaded||!e.$support.tracking.childs[n].ready)return!1;return!0}function callReadied(e,n,t){$$.isDefined(e.readied)&&e.readied(n,t),$$.isDefined(e.readiedSignal)&&e.readiedSignal.dispatch(n,t)}function callLoaded(e,n,t){$$.isDefined(e.loaded)&&e.loaded(n,t),$$.isDefined(e.loadedSignal)&&e.loadedSignal.dispatch(n,t)}function callReady(e){$$.isFunction(e.ready)&&e.ready(),$$.isDefined(e.readyLock)&&e.readyLock.unlock()}function initTracking(e,n){if(!$$.isString(n))throw"The import value must be an string with the name of the property to create on the parent object";$$.isObject(e.$support)||(e.$support={}),$$.isObject(e.$support.tracking)||(e.$support.tracking={childs:{}}),e.readyLock=$$.lock(),e.loadedSignal=$$.signal(),e.readiedSignal=$$.signal(),e.$support.tracking.childs[n]={},e.$support.tracking.childs[n].load=function(n,t){e[n]=t,e.$support.tracking.childs[n].loaded=!0,callLoaded(e,n,t),e.$support.tracking.childs[n].propertyName=n,$$.isDefined(t.$support)&&$$.isDefined(t.$support.tracking)?(e.$support.tracking.childs[n].ready=!1,t.$support.tracking.parent=e,t.$support.tracking.parentState=e.$support.tracking.childs[n]):(e.$support.tracking.childs[n].ready=!0,callReadied(e,n,t)),checkObjectReady(e)&&markReadyAndInformParent(e)},e.$support.tracking.childs[n].loaded=!1,e.$support.tracking.childReady=function(n,t){checkObjectReady(e)&&markReadyAndInformParent(e)}}function createComponentShadyDomAccesor(e){var n=function(){return{nodes:e.$componentTemplateNodes}};return n}function isChildOf(e,n){for(var t=ko.virtualElements.childNodes(e),r=0;r<t.length;r++)if(t[r]==n)return!0;return!1}function findParent(e){for(var n=e.previousSibling;null!=n;){if(isChildOf(n,e))return n;n=n.previousSibling}return null==n?e.parentNode:void 0}function createModelExporterAccessor(e,n,t,r,o){var i=function(){var n=Array(),t=findParent(e);if(t=findParent(t),8==t.nodeType){var r=t.nodeValue.match(/qk-[\w]+[\s]*=[\s]*[\'\"][\s\S]+?[\'\"]/g);if(r)for(var o=0;o<r.length;o++){var i=r[o],a=i.split("="),s=a[0].toString().trim().replace("qk-",""),c=a[1].toString().trim();n.push(document.createComment("ko "+s+": "+c)),n.push(document.createComment("/ko"))}}else if(t.attributes)for(var o=0;o<t.attributes.length;o++){var u=t.attributes[o];u.specified&&0===u.name.indexOf("qk-")&&(n.push(document.createComment("ko "+u.name.replace("qk-","")+": "+u.value)),n.push(document.createComment("/ko")))}return{nodes:n,"if":n.length>0}};return i}function createContentAccesor(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){return $$.isInt(i)?{nodes:o.$componentTemplateNodes.slice(i)}:$$.isDefined(i)?{nodes:$(o.$componentTemplateNodes).filter(i)}:{nodes:o.$componentTemplateNodes}};return a}function createHasContentAccesor(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){return $(o.$componentTemplateNodes).filter(i).length>0};return a}function createHasPageAccessor(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){var e=$$.routing.current();return $$.isDefined(e.route.components[i])?!0:!1};return a}function QuarkRouter(){function e(e,r,o){var i=this,a=t[e].router.addRoute(hash,function(e){function t(e){var t=n.current();if(t&&t.route.controller!=e){if(t.controller&&t.controller.leaving&&t.controller.leaving()===!1)return;t.controller&&(t.controller.errorHandler&&t.controller.errorHandler.clear(),t.route.persistent||(delete t.controller,delete t.route.controller))}n.current({route:i,params:i.params,controller:e}),e&&e.show&&e.show(),n.routed.dispatch(),n.firstRouting.unlock()}function r(e){if(i.controller=e,e&&(e.errorHandler&&console.warn("This controller already have a property named errorHandler, wich will be replaced by the error handler."),e.errorHandler=new ComponentErrors(e),i&&$$.isObject(i.components)))for(var n in i.components)initTracking(e,n)}for(var o in i.params)i.params[o](e[o]);$$.isString(controller)?require([controller],function(e){var n;i.controller?n=i.controller:(n=$$.isFunction(e)?new e(i):e,r(n)),t(n)}):$$.isFunction(controller)?controller(function(e){r(e),t(e)}):(r(controller),t(controller))});o.params={};for(var s in a._paramsIds)o.params[a._paramsIds[s]]=ko.observable();i.interpolate=function(e){return a.interpolate(e)}}var n=this;this.current=ko.observable(),this.configuration={},this.locationFinders=[];var t={};this.configure=function(r){for(var o in r){var i,a=r[o];i=n.configuration[o]?n.configuration[o]:n.configuration[o]={},a.config&&(i.config||(i.config={}),$.extend(i.config,a.config)),t[o]||(t[o]={});for(var s in a.routes){var c={};$$.isDefined(a.defaults)&&$.extend(c,a.defaults);var u=a.routes[s];$.extend(c,u.components),i.routes||(i.routes={}),i.routes[s]={hash:u.hash,fullName:o+"/"+s,controller:u.controller,persistent:u.persistent,components:c},t[o].csRouter||(t[o].csRouter=crossroads.create(),t[o].csRouter.normalizeFn=crossroads.NORM_AS_OBJECT,t[o].csRouter.ignoreState=!0);var l=new e(o,s,i.routes[s]);t[o].routes[s]=l}}},this.parse=function(e){var t=!1;for(var r in n.locationFinders){var o=n.locationFinders[r];if(o(function(n){t=!0,n.csRouter.parse(e)}),t)return}},this.getRoute=function(e){var t=e.substr(0,e.indexOf("/")),r=e.substr(e.indexOf("/")+1);if(!r)throw new"You must specifiy route name in the form location/routeName.";return n.configuration[t]?n.configuration[t].routes[r]||console.warn("The route name specified as "+e+" was not found in the routing configuration for the "+t+" location."):console.warn("The location specified as "+e+" was not found in the routing configuration."),n.configuration[t]&&n.configuration[t].routes[r]?n.configuration[t].routes[r]:void 0},this.hash=function(e,t){var r=n.getRoute(e);return r?r.interpolate(t):void 0},this.activateHasher=function(e){function t(t,r){$$.isDefined(e)?e(t,r):n.parse(t)}hasher.initialized.add(t),hasher.changed.add(t),hasher.init()},this.routed=new signals.Signal,this.firstRouting=$$.lock()}function validateValue(e,n){n||(n=this),n.validationReset();for(var t in n.validationConfig){var r=n.validationConfig[t];if(ko.validators[t]){var o=ko.validators[t](n,r);if(!o.validate(e))return n.errorHandler&&(n.errorKey=n.errorHandler.add(n.validationMessage(),{level:100,type:"validation"})),!1}}return!0}function setFormGroupErrorClass(e,n,t,r,o){var i=n(),a=!1;if($$.isArray(i)){for(var s=0;s<i.length;s++)if(!i[s].hasError()){a=!0;break}}else a=i.hasError();a?$(e).addClass("has-error"):$(e).removeClass("has-error")}var $$={};$$.started=!1,$$.ajaxErrorHandlers={},$$.formatters={},$$.isDefined=function(e){return"undefined"==typeof e?!1:!0},$$.isString=function(e){return"string"==typeof e||e instanceof String?!0:!1},$$.isInt=function(e){return Number(e)===e&&e%1===0},$$.canBeInt=function(e){return Number(e)==e&&e%1===0},$$.isNumeric=function(e){return"number"==typeof e},$$.isDecimal=function(e){return e===Number(e)&&e%1!==0},$$.isArray=function(e){return $.isArray(e)},$$.isObject=function(e){return null===e||"object"!=typeof e||e instanceof Array?!1:!0},$$.isFunction=function(e){return null!==e&&"function"==typeof e?!0:!1},$$.isDate=function(e){return e instanceof Date?!0:!1},$$.isValidDate=function(e){return $$.isDate(e)?isNaN(e.getTime())?!1:!0:!1},$$.clone=function(e){return $.extend(!0,{},e)},$$.cloneObservable=function(e){return komapping.fromJS(komapping.toJS(e))},$$.cloneMixed=function(e){var n=new e.constructor;for(var t in e){var r;ko.isObservable(e[t])?(r=e[t](),$$.isObject(r)?n[t]=ko.observable($$.cloneMixed(r)):n[t]=ko.observable(r)):(r=e[t],$$.isObject(r)?n[t]=$$.cloneMixed(r):n[t]=r)}return n},$$.call=function(e){if(ko.isObservable(e)&&(e=e()),ko.isObservable(e))throw"Callback can not be an observable";if($$.isFunction(e)){var n=Array.prototype.slice.call(arguments,1);return e.apply(null,n)}},$$.makeDate=function(e,n){if($$.isDate(e)||(e=new Date(e)),!$$.isValidDate(e)){if(!n)return void 0;e=new Date}return e},$$.toShortISO=function(e){return $$.isDate(e)?e.toISOString().slice(0,10):void 0},$$.clear=function(e){$.each(e,function(e,n){ko.isObservable(n)?n(void 0):n=void 0})},$$.undefine=function(e){ko.isObservable(e)?e(void 0):e=void 0},$$.formatString=function(){for(var e=Array.prototype.slice.call(arguments),n=e[0],t=1;t<e.length;t++)n=replaceAll(n,"{"+(t-1)+"}",e[t]);return n},$$.formatStringObj=function(e,n){for(var t in n)e=replaceAll(e,"{"+t+"}",n[t]);return e},ko.associativeObservable=function(e){function n(){return arguments.length>0?(n.underlying(arguments[0]),this):n.underlying()}return n.underlying=ko.observable(e),n.add=function(e,t){var r=n.underlying();r||(r={}),r[e]=t,n.underlying(r)},n.get=function(e){var t=n.underlying();return t?t[e]:void 0},n.remove=function(e){var t=n.underlying();t&&$$.isDefined(t[e])&&delete t[e],n.underlying(t)},n.array=ko.pureComputed(function(){var e=n.underlying(),t=[];if(e)for(var r in e){var o=e[r];t.push(o)}return t}),n.each=function(e){var t=n.underlying();if(t)for(var r in t)e(r,t[r])},n.subscribe=function(e){return n.underlying.subscribe(e)},n},ko.observable.fn.refresh=function(){var e=this();$$.undefine(this),this(e)},ko.isObservableArray=function(e){return ko.isObservable(e)&&void 0!==e.indexOf?!0:!1},ko.isComputed=function(e){return null===e||void 0===e||void 0===e.__ko_proto__?!1:e.__ko_proto__===ko.dependentObservable?!0:ko.isComputed(e.__ko_proto__)},ko.mapToJS=function(e){return komapping.toJS(komapping.fromJS(e))},ko.mapFromJS=function(e){return komapping.fromJS(komapping.toJS(e))},ko.bindingHandlers.href={update:function(e,n,t,r,o){var i=ko.unwrap(n()),a=function(){if($$.isString(i))return{href:"#"+$$.routing.hash(i)};if($$.isObject(i)){var e;return i.page&&(e=i.page),i.routeName&&(e+="#"+$$.routing.hash(i.routeName,i.routeConfig)),{href:e}}};return ko.bindingHandlers.attr.update(e,a,t,r,o)}},ko.bindingHandlers.onBind={init:function(e,n,t,r,o){var i=ko.unwrap(n());i(e,r,o)}},ko.bindingHandlers.format={init:function(e,n){var t=n();if(!$$.isDefined(t.value)||!$$.isString(t.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";ko.isObservable(t.value)||(t.value=ko.observable(t.value));var r=ko.pureComputed({read:function(){return $$.isDefined(t.value())&&$$.isDefined(t.formatter)?$$.formatters[t.formatter](t.value()):t.value()}});ko.applyBindingsToNode(e,{text:r})}},ko.bindingHandlers.formatValue={init:function(e,n){var t=n();if(!$$.isDefined(t.value)||!$$.isString(t.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";ko.isObservable(t.value)||(t.value=ko.observable(t.value));var r=ko.pureComputed({read:function(){return $$.isDefined(t.value())&&$$.isDefined(t.formatter)?$$.formatters[t.formatter](t.value()):t.value()}});ko.applyBindingsToNode(e,{value:r})}},$$.signal=function(){return new signals.Signal},$$.signalClear=function(e){e.removeAll()},$$.lock=function(){return new SyncLock},$$.wait=function(e,n){e.call(n)},$$.isLocked=function(e){return e.isLocked()},$$.redirect=function(e){return window.location.href=e,!0},$$.redirectHash=function(e,n){var t=$$.routing.hash(e,n);$$.redirect("#"+t)},$$.getParam=function(e){var n=void 0,t=[];return location.search.substr(1).split("&").forEach(function(r){t=r.split("="),t[0]===e&&(n=decodeURIComponent(t[1]))}),n},$$.replaceAndBind=function(e,n,t){$(e).html(n),ko.cleanNode(e.get(0)),ko.applyBindings(t,e.get(0))},$$.htmlEncode=function(e){return e?$("<div />").text(e).html():""},$$.htmlDecode=function(e){return e?$("<div />").html(e).text():""},$$.limitText=function(e,n){return $$.isInt(n)?6>n&&(n=6):n=6,$$.isString(e)?(e.length>n&&(e=e.substr(0,n-3)+"..."),e):""},$$.setCookie=function(e,n,t){var r=new Date;if(void 0!==t){r.setTime(r.getTime()+1e3*t);var o="expires="+r.toUTCString();document.cookie=e+"="+n+"; "+o}else document.cookie=e+"="+n+"; "},$$.getCookie=function(e){e+="=";for(var n=document.cookie.split(";"),t=0;t<n.length;t++){for(var r=n[t];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""},$$.clearCookie=function(e){$$.setCookie(e,"",-1)},$$.loadCss=function(e){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)};var authorizing=!1;$$.ajaxConfig={contentType:"application/json",dataType:"json",async:!0,cache:!1,authorization:{has:function(){return!0},configAuthorization:function(e){return e},authorize:function(e,n){n(!0)}}},$$.ajax=function(e,n,t,r,o,i){function a(){l=l.authorization.configAuthorization(l),$.ajax(l)}var s=i||{},c=r||{};if(!e)throw"Must specify the target URL";var u;$$.isFunction(c)?u=c:$$.isObject(c)&&(u=c.onSuccess);var l={url:e,type:n||"GET",data:t,success:u,complete:function(){$$.isDefined(c.onComplete)&&c.onComplete()},error:function(n,t,r){var o=!1;if($$.isDefined(c.onError)&&(o=c.onError(n,t,r)),!o)for(var i in $$.ajaxErrorHandlers)if($$.ajaxErrorHandlers[i](e,s.source,n,t,r)){o=!0;break}}};l=$.extend(l,$$.ajaxConfig),l=$.extend(l,s),!authorizing&&o?l.authorization.has()?a():(authorizing=!0,l.authorization.authorize(function(e){authorizing=!1,e&&a()})):$.ajax(l)};var errorKeys=1,globalErrors=ko.observableArray();$$.globalErrors=new ComponentErrors,$$.start=function(e){$$.started||(ko.applyBindings(e),$$.started=!0)},$$.module=function(e,n,t){if(!$$.isDefined(e))throw"Must specify the module configuration. You can define 'module' as dependency and pass that value in this parameter";var r=e.id.substring(0,e.id.lastIndexOf("/")),o=e.uri.substring(0,e.uri.lastIndexOf("/"));if($$.modules.get(r))return $$.modules.get(r);if(n||(n={}),$$.isDefined(n.require)){if(n.require.paths)for(var i in n.require.paths)n.require.paths[i]=o+"/"+n.require.paths[i];require(n.require)}if(n.components)for(var a in n.components){var s=n.prefix+"-"+a,c=r+"/"+n.components[a];$$.registerComponent(s,c)}if(n.namespaces)for(var u in n.namespaces){var l;l=n.prefix?n.prefix+"-"+u:u;var d=$$.onNamespace(l),p=n.namespaces[u];for(var $ in p){var c=r+"/"+p[$];d.register($,c)}}if($$.isArray(n.css))for(var f=0;f<n.css.length;f++)$$.loadCss(o+"/"+n.css[f]);var h={};return t&&(h=new t(r)),h.start&&h.start(),$$.modules.add(r,{name:r,path:o,info:e,config:n,main:h}),$$.modules.get(r)},$$.component=function(e,n){function t(n){var t,r={};if(e&&!t){t=new e(n,r);var o=new ComponentErrors($$.controller,t);t&&(t.errorHandler&&console.warn("This component already have a property named errorHandler, wich will be replaced by the error handler."),t.errorHandler=o),t&&$$.isFunction(t.initComponent)&&t.initComponent(),r.model=t,r.errorHandler=o,r.controller=$$.controller}this.getModel=function(){return t},this.getScope=function(){return r},this.dispose=function(){t&&t.dispose&&t.dispose(),t&&t.readyLock&&$$.undefine(t.readyLock),t&&t.readiedSignal&&($$.signalClear(t.readiedSignal),$$.undefine(t.readiedSignal)),t&&t.loadedSignal&&($$.signalClear(t.loadedSignal),$$.undefine(t.loadedSignal)),r&&r.dispose&&r.dispose(),t&&t.errorHandler&&(t.errorHandler.clear(),$$.undefine(t.errorHandler)),$$.undefine(t),$$.undefine(r)}}return $$.isDefined(n)||(n=e,$$.undefine(e)),e?{template:n,viewModel:t}:{template:n}},$$.registerComponent=function(e,n){ko.components.register(e,{require:n})},$$.onNamespace=function(e){var n=this,t=e;return this.register=function(e,r){return $$.registerComponent(t+"-"+e,r),n},n},$$.parameters=function(e,n,t){if(!$$.isObject(e))throw"You must specify a parameters config object";if(!$$.isObject(n))throw"You must specify the configured values for the component, usually you can obtain it from the parameters array received in the component's constructor.";if(!$$.isDefined(t))throw"You must specify the viewmodel of the component in wich to load the parameters.";$$.isArray(t)||(t=Array(t));for(var r in e)for(var o=0;o<t.length;o++){var i=t[o];if($$.isDefined(i[r])&&console.warn("There is already a property named "+r+" in the target component. It will be replaced with the specified parameter."),i[r]=e[r],$$.isDefined(n[r]))if(ko.isObservable(i[r])&&ko.isObservable(n[r]))ko.isComputed(i[r])||(i[r]=n[r]);else if(ko.isObservable(i[r])&&!ko.isObservable(n[r]))i[r](n[r]);else if(!ko.isObservable(i[r])&&ko.isObservable(n[r]))i[r]=n[r]();else if(!ko.isObservable(i[r])&&!ko.isObservable(n[r]))if($$.isFunction(i[r])){if($$.isFunction(n[r]))i[r]=n[r];else if($$.isDefined(n[r]))throw"The parameter "+r+" must be a callback."}else i[r]=n[r]}},$$.inject=function(e,n,t){if($$.isDefined(e)&&$$.isDefined(n))for(var r in e)if($$.isDefined(n[r])){var o;o=ko.isObservable(e[r])?e[r]():e[r],ko.isObservable(n[r])?t&&$$.isObject(n[r]())?$$.inject(o,n[r](),!0):n[r](o):t&&$$.isObject(n[r])?$$.inject(o,n[r],!0):n[r]=o}};var behaviours={};$$.behaviour=function(e,n,t){if($$.behaviour[e]&&console.warn("There was already a behaviour loaded with the name "+e+". It will be replaced with the new one."),!$$.isString(e))throw"The behaviour name must be an string.";if(!$$.isFunction(n))throw"The behaviour must be a function that takes an object as a parameter an applies the new functionality to it.";if($$.isDefined(t)&&!$$.isFunction(t))throw"The behaviour dispose must be a function that performs cleanup of the behaviour when disposing.";n.dispose=t,behaviours[e]=n},$$.behave=function(e,n){if(!$$.isObject(e))throw"You must specifify a valid object to apply the behaviour.";if($$.isArray(n))for(var t=0;t<n.length;t++)applyBehaviour(e,n[t]);else{if(!$$.isString(n))throw"The behaviour name must be an string or an array of strings.";applyBehaviour(e,n)}},$$.hasBehaviour=function(e,n){if(!$$.isObject(e))throw"You must specifify a valid object to check the behaviour.";if(!$$.isString(n))throw"The behaviour name must be an string.";return $$.isDefined(e.$support)&&$$.isDefined(e.$support.behaviours)&&$$.isDefined(e.$support.behaviours[n])?!0:!1},$$.disposeBehaviours=function(e){if(!$$.isObject(e))throw"You must specifify a valid object to apply the behaviour.";if($$.isDefined(e.$support)&&$$.isDefined(e.$support.behaviours))for(var n in e.$support.behaviours){var t=e.$support.behaviours[n];t.dispose&&t.dispose(e)}},$$.modules=ko.associativeObservable({}),ko.components.register("quark-component",{template:"<!-- ko componentShadyDom --><!-- /ko --><!-- ko modelExporter --><!-- /ko -->"}),$$.emptyTemplate=function(e){return e?"<!-- quark-component --><!-- /quark-component -->":"<quark-component></quark-component>"},ko.bindingProvider.instance.preprocessNode=function(e){if(8==e.nodeType){var n=e.nodeValue.match(/^\s*(quark-component[\s\S]+)/);if(n)return e.data=" ko component: { name: 'quark-component' } ",e;var n=e.nodeValue.match(/^\s*(\/quark-component[\s\S]+)/);if(n)return e.data=" /ko ",e;var n=e.nodeValue.match(/^\s*\$\$[\s\S]+}/);if(n){e.data=e.data.replace(n," ko component: { name:"+n.toString().replace("$$","").trim()+" }");var t=document.createComment("/ko");return e.parentNode.insertBefore(t,e.nextSibling),[e,t]}}},ko.bindingHandlers["import"]={init:function(e,n,t,r,o){var i,a=n();i=r&&r.model?r.model:r,initTracking(i,a),i[a]={},8!=e.nodeType?e.setAttribute("qk-export","'"+a+"'"):e.data+=" qk-export='"+a+"'"}},ko.virtualElements.allowedBindings["import"]=!0,ko.bindingHandlers["export"]={init:function(e,n,t,r,o){var i;i=ko.unwrap(n()),r&&r.model&&(r=r.model);var a;if($$.isString(i)?a=i:$$.isObject(i)&&($$.isString(i.property)&&(a=i.property),$$.isDefined(i.model)&&(r=i.model)),!$$.isString(a))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";if(!$$.isDefined(r.$support)||!$$.isDefined(r.$support.tracking))throw"The specified object doesn´t have the tracking.childs property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs))throw"The specified object doesn´t have the tracking property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs[a]))throw"The specified object doesn´t have a property named "+i+". Verify that the object has a property defined with the .components method with the name defined in the vm binding.";r.$support.tracking.childs[a].load(a,o.$child)}},ko.virtualElements.allowedBindings["export"]=!0,ko.bindingHandlers.exporttocontroller={init:function(e,n,t,r,o){var i;i=ko.unwrap(n());var a=$$.routing.current();if(a&&a.controller){r=a.controller;var s;if($$.isString(i)?s=i:$$.isObject(i)&&($$.isString(i.property)&&(s=i.property),$$.isDefined(i.model)&&(r=i.model)),!$$.isString(s))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";if(!$$.isDefined(r.$support)||!$$.isDefined(r.$support.tracking))throw"The specified object doesn´t have the tracking.childs property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs))throw"The specified object doesn´t have the tracking property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!$$.isDefined(r.$support.tracking.childs[s]))throw"The specified object doesn´t have a property named "+i+". Verify that the object has a property defined with the .components method with the name defined in the vm binding.";r.$support.tracking.childs[s].load(s,o.$child)}}},ko.virtualElements.allowedBindings.exporttocontroller=!0,ko.bindingHandlers.componentShadyDom={init:function(e,n,t,r,o){var i=createComponentShadyDomAccesor(o);return o.$parentContext.$data=o.$parent.getScope(),o.$parentContext.$rawData=o.$parent.getScope(),ko.bindingHandlers.template.init(e,i,t,o.$parent.getScope(),o.$parentContext)},update:function(e,n,t,r,o){var i=createComponentShadyDomAccesor(o);return o.$parentContext.$data=o.$parent.getScope(),o.$parentContext.$rawData=o.$parent.getScope(),ko.bindingHandlers.template.update(e,i,t,o.$parent.getScope(),o.$parentContext)}},ko.virtualElements.allowedBindings.componentShadyDom=!0,ko.bindingHandlers.modelExporter={init:function(e,n,t,r,o){var i=createModelExporterAccessor(e,n,t,r,o),a=o.$parentContext.$parentContext.extend({$child:o.$parent.getModel(),$childContext:o});return ko.bindingHandlers.template.init(e,i,t,o.$parent,a)},update:function(e,n,t,r,o){var i=createModelExporterAccessor(e,n,t,r,o),a=o.$parentContext.$parentContext.extend({$child:o.$parent.getModel(),$childContext:o});return ko.bindingHandlers.template.update(e,i,t,o.$parent,a)}},ko.virtualElements.allowedBindings.modelExporter=!0,ko.bindingHandlers.content={init:function(e,n,t,r,o){var i=createContentAccesor(e,n,t,r,o),a=o.$parentContext.extend({$child:r.model,$childContext:o});return ko.bindingHandlers.template.init(e,i,t,o.$parent,a)},update:function(e,n,t,r,o){var i=createContentAccesor(e,n,t,r,o),a=o.$parentContext.extend({$child:r.model,$childContext:o});return ko.bindingHandlers.template.update(e,i,t,o.$parent,a)}},ko.virtualElements.allowedBindings.content=!0,ko.bindingHandlers.hasContent={init:function(e,n,t,r,o){var i=createHasContentAccesor(e,n,t,r,o);return ko.bindingHandlers["if"].init(e,i,t,o,o)}},ko.virtualElements.allowedBindings.hasContent=!0,ko.bindingHandlers.hasNotContent={init:function(e,n,t,r,o){var i=createHasContentAccesor(e,n,t,r,o);return ko.bindingHandlers.ifnot.init(e,i,t,o,o)}},ko.virtualElements.allowedBindings.hasNotContent=!0,ko.bindingHandlers.page={init:function(element,valueAccessor,allBindingsAccessor,viewModel,context){var name=ko.unwrap(valueAccessor()),c=ko.observable(),p=ko.observable(),updater=ko.computed(function(){var current=$$.routing.current(),component,params;if($$.isArray(current.route.components[name])){component=current.route.components[name][0];var componentParams=current.route.components[name][1];$$.isString(componentParams)&&eval("params = {"+componentParams+"}"),$$.isObject(componentParams)&&$$.isString(componentParams.controller)&&eval("params = $$.controller."+componentParams.controller+"()")}else component=current.route.components[name],params=current;var persistent=!1;"!"==component.charAt(0)&&(persistent=!0,component=component.substr(1)),c()==component&&persistent||(c(component),p(params))}),newAccesor=function(){return{name:c,params:p}};return 8!=element.nodeType?element.setAttribute("qk-exporttocontroller","'"+name+"'"):element.data+=" qk-exporttocontroller='"+name+"'",ko.utils.domNodeDisposal.addDisposeCallback(element,function(){updater.dispose()}),ko.bindingHandlers.component.init(element,newAccesor,allBindingsAccessor,viewModel,context)}},ko.virtualElements.allowedBindings.page=!0,ko.bindingHandlers.hasPage={init:function(e,n,t,r,o){var i=createHasPageAccessor(e,n,t,r,o);return ko.bindingHandlers["if"].init(e,i,t,r,o)}},ko.virtualElements.allowedBindings.hasPage=!0,ko.bindingHandlers.waitReady={init:function(e,n,t,r,o){var i=n(),a=ko.observable(!1);return r&&r.readiedSignal&&r.readiedSignal.addOnce(function(e){e==i&&a(!0)}),ko.bindingHandlers["if"].init(e,a,t,r,o)}},ko.virtualElements.allowedBindings.waitReady=!0,ko.bindingHandlers.namespace={init:function(e,n,t,r,o){var i=n(),a=t.get("alias")||400;if(!$$.isString(i))throw"Must specify namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";if(!$$.isString(a))throw"Must specify alias to namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";var s=i.toLowerCase();a=a.toLowerCase(),o&&(o.namespaces||(o.namespaces={}),o.namespaces[a]=s)}},ko.virtualElements.allowedBindings.namespace=!0,ko.components.getComponentNameForNode=function(e){var n=e.tagName&&e.tagName.toLowerCase();if(ko.components.isRegistered(n))return n;if(-1!==n.indexOf(":")){var t=n.split(":"),r=t[0],o=t[1],i=ko.contextFor(e);if(i&&$$.isObject(i.namespaces)&&i.namespaces[r]){var a=i.namespaces[r],s=a+"-"+o;if(ko.components.isRegistered(s))return s}}return null},$$.routing=new QuarkRouter,$$.controller={};var controllerUpdater=ko.computed(function(){var e=$$.routing.current();e&&(e.controller?$$.controller=e.controller:$$.controller={})});return ko.validators={},ko.validate=function(e,n){var t=!0;for(var r in e){var o=e[r];ko.isObservable(o)&&o.validatable&&(o.validate(n)||(t=!1))}return t},ko.unsubscribeValidation=function(e){for(var n in e){var t=e[n];ko.isObservable(t)&&t.validatable&&t.validationSubscription&&(t.validationSubscription.dispose(),delete t.validationSubscription)}},ko.validationReset=function(e){for(var n in e){var t=e[n];ko.isObservable(t)&&t.validatable&&t.validationReset()}},ko.observable.fn.validation=function(e,n,t){return this.validatable=e,this.validationConfig=n,this.hasError=ko.observable(),this.validationMessage=ko.observable(),t&&(this.errorHandler=t),this},ko.observable.fn.validationReset=function(){this.validatable&&(this.hasError(!1),this.validationMessage(""),this.errorHandler&&this.errorKey&&this.errorHandler.resolve(this.errorKey))},ko.observable.fn.validate=function(e){return e&&!this.validationSubscription&&(this.validationSubscription=this.subscribe(validateValue,this)),validateValue(this(),this)},ko.bindingHandlers.formGroupError={init:function(e,n,t,r,o){setFormGroupErrorClass(e,n,t,r,o)},update:function(e,n,t,r,o){setFormGroupErrorClass(e,n,t,r,o)}},ko.bindingHandlers.fieldError={init:function(e,n,t,r,o){var i=function(){return n().validationMessage};ko.bindingHandlers.text.init(e,i,t,r,o)},update:function(e,n,t,r,o){var i=function(){return n().hasError},a=function(){return n().validationMessage};ko.bindingHandlers.visible.update(e,i,t,r,o),ko.bindingHandlers.text.update(e,a,t,r,o)}},"function"==typeof define&&define.amd&&define("knockout",function(){return ko}),$$});
>>>>>>> Stashed changes
