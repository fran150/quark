!function(e,n){"function"==typeof define&&define.amd?define(["knockout","jquery","knockout-mapping","crossroads","hasher","signals"],n):(e.komapping=ko.mapping,e.$$=n(e.ko,e.$,e.komapping,e.crossroads,e.hasher,e.signals))}(this,function(e,n,t,r,i,o){function a(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function s(e,n,t){return e.replace(new RegExp(a(n),"g"),t)}function u(){var e=!1,n=A.signal();this.lock=function(){e=!1},this.unlock=function(){e=!0,n.dispatch()},this.isLocked=function(){return!e},this.call=function(t){e?t():n.addOnce(function(){e=!0,t()})}}function c(e,n,t,r,i){this.key=e,this.message=r,this.data=i,this.controller=n,this.component=t,this.level=i&&i.level?i.level:2e3,this.type=i&&i.type?i.type:"",this.constructor.prototype.__proto__=Error.prototype}function l(n,t){var r=this;A.isDefined(n)||(n=""),A.isDefined(t)||(t="");var i=e.pureComputed(function(){var e=[],r=I();for(var i in r){var o=r[i];""==n&&""==t&&e.push(o),o.controller==n&&""==t&&e.push(o),o.controller==n&&o.component==t&&e.push(o)}return e});this.add=function(e,r){var i=_++,o=new c(i,n,t,e,r);return I.push(o),i},this["throw"]=function(e,n){var t=r.add(e,n);throw r.getByKey(t)},this.resolve=function(e){var n=r.getByKey(e);n&&I.remove(n)},this.getBy=function(n){return e.pureComputed(function(){var e=[],t=i();for(var r in t){var o=t[r];n(o)&&e.push(o)}return e})},this.getByKey=function(e){var n=i();for(var t in n){var r=n[t];if(r.key==e)return r}},this.getByType=function(n){return e.pureComputed(function(){var e=[],t=i();for(var r in t){var o=t[r];o.type==n&&e.push(o)}return e})},this.getByLevel=function(n,t){return e.pureComputed(function(){var e=[],r=i();for(var o in r){var a=r[o];a.level>=n&&a.level<=t&&e.push(a)}return e})},this.get=function(){return i},this.clear=function(){I.removeAll(i())}}function d(e,n,t){if(!A.isString(e))throw"The behaviour name must be an string. If you specified an array check that all elements are valid behaviour names";if(!q[e])throw"The are no behaviours loaded with the name "+e+".";q[e](n,t),A.isDefined(n.$support)||(n.$support={}),A.isDefined(n.$support.behaviours)||(n.$support.behaviours={}),n.$support.behaviours[e]=!0}function f(e){var n=function(){return{nodes:e.$componentTemplateNodes}};return n}function p(e){var n=e.$parent,t=e.$parentContext,r=e.extend({$component:n.getModel(),$componentTemplateNodes:t.$componentTemplateNodes,$data:n.getScope(),$parent:t.$parent?t.$parent.model:void 0,$parentContext:t.$parentContext,$parents:t.$parents,$rawData:n.getScope(),$root:t.$root});return A.isArray(r.$parents)&&r.$parents[0]&&r.$parents[0].model&&(r.$parents[0]=r.$parents[0].model),r}function m(n,t){for(var r=e.virtualElements.childNodes(n),i=0;i<r.length;i++)if(r[i]==t)return!0;return!1}function v(e){for(var n=e.previousSibling;null!=n;){if(m(n,e))return n;n=n.previousSibling}return null==n?e.parentNode:void 0}function h(e){if(8==e.nodeType){var n=e.nodeValue.match(/model-bind[\s]*:[\s]*\"[\s\S]*?\"/);if(n){var t=n[0].match(/\"[\s\S]*?\"/);if(t){var r=t[0].indexOf('"')+1,i=t[0].indexOf('"',r);return t[0].substring(r,i)}}}else if(e.attributes)for(var o=0;o<e.attributes.length;o++){var a=e.attributes[o];if(a.specified&&"model-bind"==a.name)return a.value}return!1}function g(e){var n=function(){var n=Array(),t=v(e);t=v(t);var r=h(t);return r&&(n.push(document.createComment(" ko "+r+" ")),n.push(document.createComment(" /ko "))),{nodes:n,"if":n.length>0}};return n}function b(e){var n=e.$parentContext.$parentContext,t=e.$parent,r=n.extend({$container:t.getModel(),$containerContext:e.$parentContext});return r}function y(e,n){C(e,n),A.isDefined(n.$support)&&A.isDefined(n.$support.tracking)&&A.isDefined(n.$support.tracking.parent)&&(n.$support.tracking.parentState.ready=!0,k(n.$support.tracking.parent,n.$support.tracking.parentState.propertyName,n),n.$support.tracking.parent.$support.tracking.childReady())}function w(e){for(var n in e.$support.tracking.childs)if(!e.$support.tracking.childs[n].loaded||!e.$support.tracking.childs[n].ready)return!1;return!0}function k(e,n,t){A.isDefined(e.readied)&&e.readied(n,t),A.isDefined(e.readiedSignal)&&e.readiedSignal.dispatch(n,t)}function $(e,n,t){A.isDefined(e.loaded)&&e.loaded(n,t),A.isDefined(e.loadedSignal)&&e.loadedSignal.dispatch(n,t)}function C(e,n){A.isFunction(n.ready)&&n.ready(),A.isDefined(e.readyLock)&&e.readyLock.unlock()}function S(e,n,t){if(!A.isString(t))throw"The import value must be an string with the name of the property to create on the parent object";A.isObject(n.$support)||(n.$support={}),A.isObject(n.$support.tracking)||(n.$support.tracking={childs:{}}),e.readyLock=A.lock(),n.loadedSignal=A.signal(),n.readiedSignal=A.signal(),n.$support.tracking.childs[t]={},n.$support.tracking.childs[t].load=function(t,r,i){n[t]=r,n.$support.tracking.childs[t].loaded=!0,$(n,t,r),n.$support.tracking.childs[t].propertyName=t,A.isDefined(i.$support)&&A.isDefined(i.$support.tracking)?(n.$support.tracking.childs[t].ready=!1,i.$support.tracking.parent=n,i.$support.tracking.parentState=n.$support.tracking.childs[t]):(n.$support.tracking.childs[t].ready=!0,k(n,t,r)),w(n)&&y(e,n)},n.$support.tracking.childs[t].loaded=!1,n.$support.tracking.childReady=function(t,r){w(n)&&y(e,n)}}function D(e,n,t){if(8==e.nodeType){var r=e.nodeValue.match(/model-bind[\s]*:[\s]*\"[\s\S]*?\"/);if(r){var i=r[0].match(/\"[\s\S]*?\"/);if(i){var o=i[0].indexOf('"')+1,a=i[0].indexOf('"',o),s=i[0].substring(o,a),u='"'+s;s&&(u+=", "),u+=t+": '"+n+"'\"",e.nodeValue=e.nodeValue.replace(i[0],u)}}else e.nodeValue+='model-bind: "'+t+": '"+n+"'\""}else{var c=!1;if(e.attributes)for(var l=0;l<e.attributes.length;l++){var d=e.attributes[l];d.specified&&"model-bind"==d.name&&(d.value&&(d.value+=", "),d.value+=t+": '"+n+"'",c=!0)}if(!c)var d=e.setAttribute("model-bind",t+": '"+n+"'")}}function N(e,n,t){if(!A.isDefined(n.$support)||!A.isDefined(n.$support.tracking))throw"The specified object doesn´t have the tracking.childs property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!A.isDefined(n.$support.tracking.childs))throw"The specified object doesn´t have the tracking property. This usually is because you don´t used the function .components to set the properties where the vm binding has to set the viewmodel";if(!A.isDefined(n.$support.tracking.childs[e]))throw"The specified object doesn´t have a property named "+e+". Verify that the object has a property defined with the .components method with the name defined in the vm binding.";n.$support.tracking.childs[e].load(e,t.$container,t.$containerContext.$data.getImports())}function x(t,r,i){var o=e.unwrap(t()),a=r.get("virtual")||!1,s=function(){if(a){for(var e=[],t=0,r=0;r<i.$componentTemplateNodes.length;r++){var s=i.$componentTemplateNodes[r];8==s.nodeType&&s.nodeValue.trim().toUpperCase()==o.toUpperCase()&&t++,t>0&&(e.push(s),8==s.nodeType&&s.nodeValue.trim().toUpperCase()=="/"+o.toUpperCase()&&t--)}return{nodes:e}}if(A.isDefined(o)){var u=n(i.$componentTemplateNodes).filter(o);return{nodes:u}}return{nodes:i.$componentTemplateNodes}};return s}function O(e){var n=e.$parentContext,t=e.$data,r=n.extend({$containerContext:e,$container:t.model});return r}function T(t,r,i){var o=e.unwrap(t()),a=r.get("virtual")||!1,s=function(){if(a){for(var e=0;e<i.$componentTemplateNodes.length;e++){var t=i.$componentTemplateNodes[e];if(8==t.nodeType&&t.nodeValue.trim().toUpperCase()==o.toUpperCase())return!0}return!1}return n(i.$componentTemplateNodes).filter(o).length>0};return s}function E(n,t,r,i,o){var a=e.unwrap(t()),s=function(){var e=A.routing.current();return A.isDefined(e.route.components[a])?!0:!1};return s}function j(){function t(n,t,r){function i(e){var i=s.current();if(i&&i.controller!=e&&i.controller){if(i.controller.leaving&&i.controller.leaving()===!1)return;i.controller.componentErrors&&i.controller.componentErrors.clear(),e&&"!"!=i.config.controller.charAt(0)&&delete u.controller,delete i.controller}s.current({locationName:n,routeName:t,config:r,params:r.params,controller:e}),e&&e.show&&e.show(),s.routed.dispatch(),s.firstRouting.unlock()}function o(e){if(e&&(e.componentErrors&&console.warn("This controller already have a property named componentErrors, wich will be replaced by the error handler."),e.componentErrors=new l(e),A.isObject(r.components)))for(var n in r.components)S(e,u.controllerImports,n)}function a(e){var n;if(A.isString(r.controller)){var t;t="!"==r.controller.charAt(0)?r.controller.substr(1):r.controller,require([t],function(t){if(!A.isFunction(t))throw"The specified controller file "+r.controller+" must return the controller's constructor";n=new t(r,u.controllerImports),u.controller=n,e(n)})}else{if(!A.isFunction(r.controller))throw"The specified controller file "+r.controller+" must return the controller's constructor";n=new r.controller(r,u.controllerImports),u.controller=n,e(n)}}var u=this;u.locationName=n,u.routeName=t,u.controllerImports={};var c=F[n].csRouter.addRoute(r.hash,function(e){for(var n in r.params)r.params[n](e[n]);u.controller?i(u.controller):A.isDefined(r.controller)?a(function(e){o(e),i(e)}):i()});for(var d in c._paramsIds)r.params[c._paramsIds[d]]=e.observable();u.interpolate=function(e){return c.interpolate(e)}}function a(e){var n=e.substr(0,e.indexOf("/")),t=e.substr(e.indexOf("/")+1);if(!t)throw new"You must specifiy route name in the form location/routeName.";return s.configuration[n]?s.configuration[n].routes[t]||console.warn("The route name specified as "+e+" was not found in the routing configuration for the "+n+" location."):console.warn("The location specified as "+e+" was not found in the routing configuration."),F[n]&&F[n].routes[t]?F[n].routes[t]:void 0}var s=this;this.current=e.observable(),this.configuration={},this.locationFinders=[],this.urlGenerators=[],this.configure=function(e){for(var i in e){var o,a=e[i];o=s.configuration[i]?s.configuration[i]:s.configuration[i]={},a.config&&(o.config||(o.config={}),n.extend(o.config,a.config)),F[i]||(F[i]={});for(var u in a.routes){var c={};A.isDefined(a.defaults)&&n.extend(c,a.defaults);var l=a.routes[u];n.extend(c,l.components),o.routes||(o.routes={}),o.routes[u]={locationName:i,routeName:u,hash:l.hash,fullName:i+"/"+u,controller:l.controller,components:c,params:{}},F[i].csRouter||(F[i].csRouter=r.create(),F[i].csRouter.normalizeFn=r.NORM_AS_OBJECT,F[i].csRouter.ignoreState=!0),F[i].routes||(F[i].routes={});var d=new t(i,u,o.routes[u]);F[i].routes[u]=d}}},this.parse=function(e){var n=!1;for(var t in s.locationFinders){var r=s.locationFinders[t];if(r(function(t){n=!0,F[t].csRouter.parse(e)}),n)return}},this.hash=function(e,n){var t=a(e);return t?t.interpolate(n):void 0},this.link=function(e,n){var t=a(e);if(t)for(var r in s.urlGenerators){var i=s.urlGenerators[r](t,n);if(i)return i}},this.activateHasher=function(e){function n(n,t){A.isDefined(e)?e(n,t):s.parse(n)}i.initialized.add(n),i.changed.add(n),i.init()},this.routed=new o.Signal,this.firstRouting=A.lock()}function H(n,t){t||(t=this),t.validationReset();for(var r in t.validationConfig){var i=t.validationConfig[r];if(e.validators[r]){var o=e.validators[r](t,i);if(!o.validate(n))return t.componentErrors&&(t.errorKey=t.componentErrors.add(t.validationMessage(),{level:100,type:"validation"})),!1}}return!0}function B(e,t,r,i,o){var a=t(),s=!1;if(A.isArray(a)){for(var u=0;u<a.length;u++)if(!a[u].hasError()){s=!0;break}}else s=a.hasError();s?n(e).addClass("has-error"):n(e).removeClass("has-error")}var A={};A.started=!1,A.ajaxErrorHandlers={},A.formatters={},A.isDefined=function(e){return"undefined"==typeof e?!1:!0},A.isString=function(e){return"string"==typeof e||e instanceof String?!0:!1},A.isInt=function(e){return Number(e)===e&&e%1===0},A.canBeInt=function(e){return Number(e)==e&&e%1===0},A.isNumeric=function(e){return"number"==typeof e},A.isDecimal=function(e){return e===Number(e)&&e%1!==0},A.isArray=function(e){return n.isArray(e)},A.isObject=function(e){return null===e||"object"!=typeof e||e instanceof Array?!1:!0},A.isFunction=function(e){return null!==e&&"function"==typeof e?!0:!1},A.isDate=function(e){return e instanceof Date?!0:!1},A.isValidDate=function(e){return A.isDate(e)?isNaN(e.getTime())?!1:!0:!1},A.clone=function(e){return n.extend(!0,{},e)},A.cloneObservable=function(e){return t.fromJS(t.toJS(e))},A.cloneMixed=function(n){var t=new n.constructor;for(var r in n){var i;e.isObservable(n[r])?(i=n[r](),A.isObject(i)?t[r]=e.observable(A.cloneMixed(i)):t[r]=e.observable(i)):(i=n[r],A.isObject(i)?t[r]=A.cloneMixed(i):t[r]=i)}return t},A.call=function(n){if(e.isObservable(n)&&(n=n()),e.isObservable(n))throw"Callback can not be an observable";if(A.isFunction(n)){var t=Array.prototype.slice.call(arguments,1);return n.apply(null,t)}},A.makeDate=function(e,n){if(A.isDate(e)||(e=new Date(e)),!A.isValidDate(e)){if(!n)return void 0;e=new Date}return e},A.toShortISO=function(e){return A.isDate(e)?e.toISOString().slice(0,10):void 0},A.clear=function(t){n.each(t,function(n,t){e.isObservable(t)?t(void 0):t=void 0})},A.undefine=function(n){e.isObservable(n)?n(void 0):n=void 0},A.formatString=function(){for(var e=Array.prototype.slice.call(arguments),n=e[0],t=1;t<e.length;t++)n=s(n,"{"+(t-1)+"}",e[t]);return n},A.formatStringObj=function(e,n){for(var t in n)e=s(e,"{"+t+"}",n[t]);return e},e.associativeObservable=function(n){function t(){return arguments.length>0?(t.underlying(arguments[0]),this):t.underlying()}return t.underlying=e.observable(n),t.add=function(e,n){var r=t.underlying();r||(r={}),r[e]=n,t.underlying(r)},t.get=function(e){var n=t.underlying();return n?n[e]:void 0},t.remove=function(e){var n=t.underlying();n&&A.isDefined(n[e])&&delete n[e],t.underlying(n)},t.array=e.pureComputed(function(){var e=t.underlying(),n=[];if(e)for(var r in e){var i=e[r];n.push(i)}return n}),t.each=function(e){var n=t.underlying();if(n)for(var r in n)e(r,n[r])},t.subscribe=function(e){return t.underlying.subscribe(e)},t},e.observable.fn.refresh=function(){var e=this();A.undefine(this),this(e)},e.isObservableArray=function(n){return e.isObservable(n)&&void 0!==n.indexOf?!0:!1},e.isComputed=function(n){return null===n||void 0===n||void 0===n.__ko_proto__?!1:n.__ko_proto__===e.dependentObservable?!0:e.isComputed(n.__ko_proto__)},e.mapToJS=function(e){return t.toJS(t.fromJS(e))},e.mapFromJS=function(e){return t.fromJS(t.toJS(e))},e.bindingHandlers.href={update:function(n,t,r,i,o){var a=e.unwrap(t()),s=function(){return A.isString(a)?{href:A.routing.link(a)}:A.isObject(a)&&a&&a.routeName&&a.routeConfig?{href:A.routing.link(a.routeName,a.routeConfig)}:void 0};return e.bindingHandlers.attr.update(n,s,r,i,o)}},e.bindingHandlers.onBind={init:function(n,t,r,i,o){var a=e.unwrap(t());a(n,i,o)}},e.bindingHandlers.format={init:function(n,t){var r=t();if(!A.isDefined(r.value)||!A.isString(r.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";e.isObservable(r.value)||(r.value=e.observable(r.value));var i=e.pureComputed({read:function(){return A.isDefined(r.value())&&A.isDefined(r.formatter)?A.formatters[r.formatter](r.value()):r.value()}});e.applyBindingsToNode(n,{text:i})}},e.bindingHandlers.formatValue={init:function(n,t){var r=t();if(!A.isDefined(r.value)||!A.isString(r.formatter))throw"Must specify format configuration in the form { value: observableValue, formatter: formatterName }";e.isObservable(r.value)||(r.value=e.observable(r.value));var i=e.pureComputed({read:function(){return A.isDefined(r.value())&&A.isDefined(r.formatter)?A.formatters[r.formatter](r.value()):r.value()}});e.applyBindingsToNode(n,{value:i})}},e.bindingHandlers.waitReady={init:function(n,t,r,i,o){var a=t(),s=e.observable(!1);return i&&i.readiedSignal&&i.readiedSignal.addOnce(function(e){e==a&&s(!0)}),e.bindingHandlers["if"].init(n,s,r,i,o)}},e.virtualElements.allowedBindings.waitReady=!0,A.signal=function(){return new o.Signal},A.signalClear=function(e){e.removeAll()},A.lock=function(){return new u},A.wait=function(e,n){e.call(n)},A.isLocked=function(e){return e.isLocked()},A.redirect=function(e){return window.location.href=e,!0},A.redirectHash=function(e,n){var t=A.routing.hash(e,n);A.redirect("#"+t)},A.getParam=function(e){var n=void 0,t=[];return location.search.substr(1).split("&").forEach(function(r){t=r.split("="),t[0]===e&&(n=decodeURIComponent(t[1]))}),n},A.replaceAndBind=function(t,r,i){n(t).html(r),e.cleanNode(t.get(0)),e.applyBindings(i,t.get(0))},A.htmlEncode=function(e){return e?n("<div />").text(e).html():""},A.htmlDecode=function(e){return e?n("<div />").html(e).text():""},A.limitText=function(e,n){return A.isInt(n)?6>n&&(n=6):n=6,A.isString(e)?(e.length>n&&(e=e.substr(0,n-3)+"..."),e):""},A.setCookie=function(e,n,t){var r=new Date;if(void 0!==t){r.setTime(r.getTime()+1e3*t);var i="expires="+r.toUTCString();document.cookie=e+"="+n+"; "+i}else document.cookie=e+"="+n+"; "},A.getCookie=function(e){e+="=";for(var n=document.cookie.split(";"),t=0;t<n.length;t++){for(var r=n[t];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""},A.clearCookie=function(e){A.setCookie(e,"",-1)},A.loadCss=function(e){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)};var R=!1;A.ajaxConfig={contentType:"application/json",dataType:"json",async:!0,cache:!1,authorization:{has:function(){return!0},configAuthorization:function(e){return e},authorize:function(e,n){n(!0)}}},A.ajax=function(e,t,r,i,o,a){function s(){d=d.authorization.configAuthorization(d),n.ajax(d)}var u=a||{},c=i||{};if(!e)throw"Must specify the target URL";var l;A.isFunction(c)?l=c:A.isObject(c)&&(l=c.onSuccess);var d={url:e,type:t||"GET",data:r,success:l,complete:function(){A.isDefined(c.onComplete)&&c.onComplete()},error:function(n,t,r){var i=!1;if(A.isDefined(c.onError)&&(i=c.onError(n,t,r)),!i)for(var o in A.ajaxErrorHandlers)if(A.ajaxErrorHandlers[o](e,u.source,n,t,r)){i=!0;break}}};d=n.extend(d,A.ajaxConfig),d=n.extend(d,u),!R&&o?d.authorization.has()?s():(R=!0,d.authorization.authorize(function(e){R=!1,e&&s()})):n.ajax(d)};var _=1,I=e.observableArray();A.globalErrors=new l,A.modules=e.associativeObservable({}),A.start=function(n){A.started||(e.applyBindings(n),A.started=!0)},A.module=function(e,n,t){function r(e,n){for(var t in n){var o,a=n[t];o=t?e+"-"+t:e,A.isString(a)?A.registerComponent(o,i+"/"+a):r(o,a)}}if(!A.isDefined(e))throw"Must specify the module configuration. You can define 'module' as dependency and pass that value in this parameter";var i=e.id.substring(0,e.id.lastIndexOf("/")),o=e.uri.substring(0,e.uri.lastIndexOf("/"));if(A.modules.get(i))return A.modules.get(i);if(n||(n={}),A.isDefined(n.require)){if(n.require.paths)for(var a in n.require.paths)n.require.paths[a]=o+"/"+n.require.paths[a];require(n.require)}if(n.components)for(var s in n.components){var u=n.prefix+"-"+s,c=i+"/"+n.components[s];A.registerComponent(u,c)}if(n.namespaces&&(n.prefix?r(n.prefix,n.namespaces):r("",n.namespaces)),n.routes&&A.routing.configure(n.routes),A.isArray(n.css))for(var l=0;l<n.css.length;l++)A.loadCss(o+"/"+n.css[l]);var d={};return t&&(d=new t(i)),d.start&&d.start(),A.modules.add(i,{name:i,path:o,info:e,config:n,main:d}),A.modules.get(i)},A.component=function(e,n){function t(n){var t,r={},i={};if(e&&!t){t=new e(n,r,i);var o=new l(A.controller,t);t&&(t.componentErrors&&console.warn("This component already have a property named componentErrors, wich will be replaced by the quark component error list."),t.componentErrors=o),i&&A.isFunction(i.initComponent)&&i.initComponent(),r.model=t,r.imports=i,r.componentErrors=o,r.controller=A.controller}this.getModel=function(){return t},this.getScope=function(){return r},this.getImports=function(){return i},this.dispose=function(){t&&t.dispose&&t.dispose(),i&&i.readyLock&&A.undefine(i.readyLock),i&&i.readiedSignal&&(A.signalClear(i.readiedSignal),A.undefine(i.readiedSignal)),i&&i.loadedSignal&&(A.signalClear(i.loadedSignal),A.undefine(i.loadedSignal)),r&&r.dispose&&r.dispose(),t&&t.componentErrors&&(t.componentErrors.clear(),A.undefine(t.componentErrors)),A.undefine(t),A.undefine(r),A.undefine(i)}}return A.isDefined(n)||(n=e,A.undefine(e)),e?{template:n,viewModel:t,modelType:e}:{template:n}},A.parameters=function(n,t,r){if(!A.isObject(n))throw"You must specify a parameters config object";if(!A.isObject(t))throw"You must specify the configured values for the component, usually you can obtain it from the parameters array received in the component's constructor.";if(!A.isDefined(r))throw"You must specify the viewmodel of the component in wich to load the parameters.";A.isArray(r)||(r=Array(r));for(var i in n)for(var o=0;o<r.length;o++){var a=r[o];if(A.isDefined(a[i])&&console.warn("There is already a property named "+i+" in the target component. It will be replaced with the specified parameter."),a[i]=n[i],A.isDefined(t[i]))if(e.isObservable(a[i])&&e.isObservable(t[i]))a[i]=t[i];else if(e.isObservable(a[i])&&!e.isObservable(t[i]))a[i](t[i]);else if(!e.isObservable(a[i])&&e.isObservable(t[i]))a[i]=t[i]();else if(!e.isObservable(a[i])&&!e.isObservable(t[i]))if(A.isFunction(a[i])){if(A.isFunction(t[i]))a[i]=t[i];else if(A.isDefined(t[i]))throw"The parameter "+i+" must be a callback."}else a[i]=t[i]}},A.inject=function(n,t,r){if(A.isDefined(n)&&A.isDefined(t))for(var i in n)if(A.isDefined(t[i])){var o;o=e.isObservable(n[i])?n[i]():n[i],e.isObservable(t[i])?r&&A.isObject(t[i]())?A.inject(o,t[i](),!0):t[i](o):r&&A.isObject(t[i])?A.inject(o,t[i],!0):t[i]=o}},A.emptyTemplate=function(e){return e?"<!-- quark-component --><!-- /quark-component -->":"<quark-component></quark-component>"},A.registerComponent=function(n,t){e.components.register(n,{require:t})},A.onNamespace=function(e){var n=this,t=e;return this.register=function(e,r){return A.registerComponent(t+"-"+e,r),n},this.namespace=function(e){return new A.onNamespace(t+"-"+e)},n};var q={};A.behaviour=function(e,n,t){if(A.behaviour[e]&&console.warn("There was already a behaviour loaded with the name "+e+". It will be replaced with the new one."),!A.isString(e))throw"The behaviour name must be an string.";if(!A.isFunction(n))throw"The behaviour must be a function that takes an object as a parameter an applies the new functionality to it.";if(A.isDefined(t)&&!A.isFunction(t))throw"The behaviour dispose must be a function that performs cleanup of the behaviour when disposing.";n.dispose=t,q[e]=n},A.behave=function(e,n,t){if(!A.isObject(n))throw"You must specifify a valid object to apply the behaviour.";if(A.isArray(e))for(var r=0;r<e.length;r++)d(e[r],n,t);else{if(!A.isString(e))throw"The behaviour name must be an string or an array of strings.";d(e,n,t)}},A.hasBehaviour=function(e,n){if(!A.isObject(e))throw"You must specifify a valid object to check the behaviour.";if(!A.isString(n))throw"The behaviour name must be an string.";return A.isDefined(e.$support)&&A.isDefined(e.$support.behaviours)&&A.isDefined(e.$support.behaviours[n])?!0:!1},A.disposeBehaviours=function(e){if(!A.isObject(e))throw"You must specifify a valid object to apply the behaviour.";if(A.isDefined(e.$support)&&A.isDefined(e.$support.behaviours))for(var n in e.$support.behaviours){var t=e.$support.behaviours[n];t.dispose&&t.dispose(e)}},e.components.register("quark-component",{template:"<!-- ko componentScope --><!-- /ko --><!-- ko modelBinder --><!-- /ko -->"}),e.bindingHandlers.componentScope={init:function(n,t,r,i,o){var a=f(o),s=p(o);return e.bindingHandlers.template.init(n,a,r,s.$data,s)},update:function(n,t,r,i,o){var a=f(o),s=p(o);return e.bindingHandlers.template.update(n,a,r,s.$data,s)}},e.virtualElements.allowedBindings.componentScope=!0,e.bindingHandlers.modelBinder={init:function(n,t,r,i,o){var a=g(n),s=b(o);return e.bindingHandlers.template.init(n,a,r,o.$parent,s)},update:function(n,t,r,i,o){var a=g(n),s=b(o);return e.bindingHandlers.template.update(n,a,r,o.$parent,s)}},e.virtualElements.allowedBindings.modelBinder=!0,e.bindingHandlers["import"]={init:function(e,n,t,r,i){var o,a,s=n();r&&r.imports&&r.model?(o=r.model,a=r.imports):(o=r,a=r),S(o,a,s),a[s]={},D(e,s,"export")}},e.virtualElements.allowedBindings["import"]=!0,e.bindingHandlers["export"]={init:function(n,t,r,i,o){var a;a=e.unwrap(t()),i&&i.model&&i.imports&&(i=i.imports);var s;if(!A.isString(a))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";s=a,N(s,i,o)}},e.virtualElements.allowedBindings["export"]=!0,e.bindingHandlers.exportToController={init:function(n,t,r,i,o){var a;a=e.unwrap(t());var s=A.routing.current();if(s&&s.controller){var a;a=e.unwrap(t()),F[s.locationName].routes[s.routeName].controllerImports&&(i=F[s.locationName].routes[s.routeName].controllerImports);var u;if(!A.isString(a))throw"The value of the vm value must be an string with the name of the property where quark must load the viewmodel of the nested component";u=a,N(u,i,o)}}},e.virtualElements.allowedBindings.exportToController=!0,e.bindingHandlers.content={init:function(n,t,r,i,o){var a=x(t,r,o),s=O(o);return e.bindingHandlers.template.init(n,a,r,o.$parent,s)},update:function(n,t,r,i,o){var a=x(t,r,o),s=O(o);return e.bindingHandlers.template.update(n,a,r,o.$parent,s)}},e.virtualElements.allowedBindings.content=!0,e.bindingHandlers.hasContent={init:function(n,t,r,i,o){var a=T(t,r,o);return e.bindingHandlers["if"].init(n,a,r,o,o)}},e.virtualElements.allowedBindings.hasContent=!0,e.bindingHandlers.hasNotContent={init:function(n,t,r,i,o){var a=T(t,r,o);return e.bindingHandlers.ifnot.init(n,a,r,o,o)}},e.virtualElements.allowedBindings.hasNotContent=!0,e.bindingHandlers.page={init:function(n,t,r,i,o){var a=e.unwrap(t()),s={component:e.observable(),parameters:e.observable()},u=e.computed(function(){var e,n=A.routing.current(),t={};if(n){if(!n.config.components[a])throw"No component defined for page "+a+" in route "+n.config.fullName;if(e=n.config.components[a],n.controller){var r=F[n.locationName].routes[n.routeName].controllerImports;r&&r.configPage&&(t=r.configPage(a),A.isObject(t)||(t={}))}var i=!1;"!"==e.charAt(0)&&(i=!0,e=e.substr(1)),s.component()==e&&i||(s.component(e),s.parameters(t))}}),c=function(){return{name:s.component,params:s.parameters}};return D(n,a,"exportToController"),e.utils.domNodeDisposal.addDisposeCallback(n,function(){u.dispose()}),e.bindingHandlers.component.init(n,c,r,i,o)}},e.virtualElements.allowedBindings.page=!0,e.bindingHandlers.hasPage={init:function(n,t,r,i,o){var a=E(n,t,r,i,o);return e.bindingHandlers["if"].init(n,a,r,i,o)}},e.virtualElements.allowedBindings.hasPage=!0;var F={};A.routing=new j,A.controller={};e.computed(function(){var e=A.routing.current();e&&(e.controller?A.controller=e.controller:A.controller={})});return A.routing.locationFinders.push(function(e){var n=window.location.pathname;for(var t in A.routing.configuration){var r=A.routing.configuration[t];n.toUpperCase()==r.config.path.toUpperCase()&&e(t)}}),A.routing.urlGenerators.push(function(e,n){var t=A.routing.configuration[e.locationName];return t&&t.config&&t.config.path?t.config.path+"#"+e.interpolate(n):void 0}),e.bindingHandlers.namespace={init:function(e,n,t,r,i){var o=n(),a=t.get("alias")||400;if(!A.isString(o))throw"Must specify namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";if(!A.isString(a))throw"Must specify alias to namespace as string. The binding must be in the form: namespace: 'namespace', alias: 'alias'";var s=o.toLowerCase();a=a.toLowerCase(),i&&(i.namespaces||(i.namespaces={}),i.namespaces[a]=s)}},e.virtualElements.allowedBindings.namespace=!0,e.bindingProvider.instance.preprocessNode=function(n){if(8==n.nodeType){var t=n.nodeValue.match(/^\s*(quark-component[\s\S]+)/);if(t)return n.data=" ko component: { name: 'quark-component' } ",n;var t=n.nodeValue.match(/^\s*(\/quark-component[\s\S]+)/);if(t)return n.data=" /ko ",n}if(n&&n.nodeName&&e.components.isRegistered(n.nodeName.toLowerCase())&&n.attributes.virtual){var r=n.attributes.params,i=n.attributes["data-bind"],o=n.attributes["model-bind"],a=" ko component: { name: '"+n.nodeName.toLowerCase()+"' ";a+=r?", params: { "+r.value+" } ":", params: {}",a+=" } ",i&&(a+=", "+i.value+" "),o&&(a+=', model-bind: "'+o.value+'"');var s=document.createComment(a),u=document.createComment(" /ko ");for(n.parentNode.insertBefore(u,n.nextSibling),n.parentNode.replaceChild(s,n);n.childNodes.length>0;)s.parentNode.insertBefore(n.childNodes[0],u);return[s,u]}},e.components.getComponentNameForNode=function(n){var t=n.tagName&&n.tagName.toLowerCase();if(e.components.isRegistered(t))return t;if(-1!==t.indexOf(":")){var r=t.split(":"),i=r[0],o=r[1],a=e.contextFor(n);if(a&&A.isObject(a.namespaces)&&a.namespaces[i]){var s=a.namespaces[i],u=s+"-"+o;if(e.components.isRegistered(u))return u}}return null},e.validators={},e.validate=function(n,t){var r=!0;for(var i in n){var o=n[i];e.isObservable(o)&&o.validatable&&(o.validate(t)||(r=!1))}return r},e.unsubscribeValidation=function(n){for(var t in n){var r=n[t];e.isObservable(r)&&r.validatable&&r.validationSubscription&&(r.validationSubscription.dispose(),delete r.validationSubscription)}},e.validationReset=function(n){for(var t in n){var r=n[t];e.isObservable(r)&&r.validatable&&r.validationReset()}},e.observable.fn.validation=function(n,t,r){return this.validatable=n,this.validationConfig=t,this.hasError=e.observable(),this.validationMessage=e.observable(),r&&(this.componentErrors=r),this},e.observable.fn.validationReset=function(){this.validatable&&(this.hasError(!1),this.validationMessage(""),this.componentErrors&&this.errorKey&&this.componentErrors.resolve(this.errorKey))},e.observable.fn.validate=function(e){return e&&!this.validationSubscription&&(this.validationSubscription=this.subscribe(H,this)),H(this(),this)},e.bindingHandlers.formGroupError={init:function(e,n,t,r,i){B(e,n,t,r,i)},update:function(e,n,t,r,i){B(e,n,t,r,i)}},e.bindingHandlers.fieldError={init:function(n,t,r,i,o){var a=function(){return t().validationMessage};e.bindingHandlers.text.init(n,a,r,i,o)},update:function(n,t,r,i,o){var a=function(){return t().hasError},s=function(){return t().validationMessage};e.bindingHandlers.visible.update(n,a,r,i,o),e.bindingHandlers.text.update(n,s,r,i,o)}},"function"==typeof define&&define.amd&&define("knockout",function(){return e}),A});